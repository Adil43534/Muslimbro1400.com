<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Sahih al-Bukhari - MuslimBro1400</title>
  <link href="https://fonts.googleapis.com/css2?family=Segoe+UI:wght@400;600&family=Noto+Naskh+Arabic:wght@400;700&family=Noto+Nastaliq+Urdu:wght@400;700&family=Amiri:wght@400;700&display=swap" rel="stylesheet" />
  <link rel="icon" href="favicon.png" type="image/x-icon">
  <style>
/* ---------- COMPLETE STYLESHEET (merged + enhanced + global scroll bars) ---------- */
    @font-face {
      font-family: 'Jameel Noori Nastaleeq';
      src: url('https://db.onlinewebfonts.com/t/173976378411b22976d3381e494d4ef7.woff2') format('woff2'),
           url('https://db.onlinewebfonts.com/t/173976378411b22976d3381e494d4ef7.woff') format('woff'),
           url('https://db.onlinewebfonts.com/t/173976378411b22976d3381e494d4ef7.ttf') format('truetype');
      font-display: swap;
    }

    * { box-sizing: border-box;}
    body {
      margin: 0;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background-color: #f9f9f9;
      color: #333;
      transition: background-color 0.5s ease, color 0.5s ease;
    }
    body.dark-mode {
      background-color: #1a1a1a;
      color: #e0e0e0;
    }

    /* ---------- GLOBAL SCROLL BAR STYLING (THEME MATCHING) ---------- */

    /* WebKit Browsers (Chrome, Safari, Edge, Opera) */
    ::-webkit-scrollbar {
      width: 10px;
      height: 10px;
    }

    ::-webkit-scrollbar-track {
      background: #f1f1f1;
      border-radius: 10px;
    }

    ::-webkit-scrollbar-thumb {
      background: #007b5e;
      border-radius: 10px;
      border: 2px solid #f1f1f1;
      transition: all 0.3s ease;
    }

    ::-webkit-scrollbar-thumb:hover {
      background: #005f4a;
    }

    ::-webkit-scrollbar-corner {
      background: #f1f1f1;
    }

    /* Dark mode scroll bars */
    .dark-mode ::-webkit-scrollbar-track {
      background: #2c2c2c;
    }

    .dark-mode ::-webkit-scrollbar-thumb {
      background: #0c8;
      border: 2px solid #2c2c2c;
    }

    .dark-mode ::-webkit-scrollbar-thumb:hover {
      background: #0a6;
    }

    .dark-mode ::-webkit-scrollbar-corner {
      background: #2c2c2c;
    }

    /* Firefox scroll bar styling */
    * {
      scrollbar-width: thin;
      scrollbar-color: #007b5e #f1f1f1;
    }

    .dark-mode * {
      scrollbar-color: #0c8 #2c2c2c;
    }

    /* Body scroll bar (for the main page) */
    body::-webkit-scrollbar {
      width: 12px;
      height: 12px;
    }

    body::-webkit-scrollbar-track {
      background: #f1f1f1;
    }

    body::-webkit-scrollbar-thumb {
      background: #007b5e;
      border-radius: 12px;
      border: 3px solid #f1f1f1;
    }

    body::-webkit-scrollbar-thumb:hover {
      background: #005f4a;
    }

    .dark-mode body::-webkit-scrollbar-track {
      background: #2c2c2c;
    }

    .dark-mode body::-webkit-scrollbar-thumb {
      background: #0c8;
      border: 3px solid #2c2c2c;
    }

    .dark-mode body::-webkit-scrollbar-thumb:hover {
      background: #0a6;
    }

    /* ---------- NAVBAR ---------- */
    .navbar {
      display: flex;
      flex-wrap: wrap;
      justify-content: space-between;
      align-items: center;
      padding: 1rem 2rem;
      background-color: #f0f0f0;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      transition: background-color 0.5s ease;
      position: sticky;
      top: 0;
      z-index: 1000;
    }

    .dark-mode .navbar {
      background-color: #2c2c2c;
    }

    .nav-links {
      display: flex;
      align-items: center;
    }

    .nav-links a {
      margin-left: 1rem;
      text-decoration: none;
      color: #333;
      font-weight: 500;
    }

    .dark-mode .nav-links a {
      color: #e0e0e0;
    }

    .nav-links a:hover {
      color: #007b5e;
    }

    .dark-mode .nav-links a:hover {
      color: #0c8;
    }

    .theme-toggle {
      cursor: pointer;
      margin-left: 1rem;
      background-color: transparent;
      border: none;
      padding: 0.4rem 0.6rem;
      border-radius: 4px;
    }

    .theme-toggle img {
      width: 24px;
      height: 24px;
      transition: transform 0.3s ease;
    }

    .theme-toggle img.rotate {
      transform: rotate(180deg);
    }

    .menu-toggle {
      display: none;
      cursor: pointer;
      background-color: transparent;
      border: none;
      padding: 0.4rem 0.6rem;
    }

    .menu-toggle img {
      width: 24px;
      height: 24px;
    }
    
    .banner {
      width: 100%;
      overflow: hidden;
    }
    .banner-img {
      width: 100%;
      height: auto;
      max-height: 300px;
      object-fit: cover;
    }
    /* ---------- CONTAINER & CARDS ---------- */
    .container { 
      max-width: 1200px; 
      margin: auto; 
      padding: clamp(0.5rem, 3vw, 2rem) clamp(0.3rem, 2vw, 1rem);
      width: 100%;
      overflow-x: hidden;
    }
    
    h1 {
      text-align: center;
      margin-bottom: 1rem;
      font-family: 'Segoe UI', Tahoma, sans-serif;
    }
    
    .description { 
      font-family: 'Segoe UI', Tahoma, sans-serif;
      text-align: center; 
      margin-bottom: 2rem; 
      color: #555; 
      max-width:800px; 
      margin-left:auto; 
      margin-right:auto; 
    }
    .dark-mode .description { color: #ccc; }

    /* ------- OPTIMIZED FLUID CARD GRID (responsive across all screens) ------- */
    .cards-vertical-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(clamp(120px, 15vw, 180px), 1fr));
      gap: 1rem;
      padding: 1rem;
      max-height: 70vh;
      overflow-y: auto;
      scroll-behavior: smooth;
    }

    /* Cards vertical grid scroll bar */
    .cards-vertical-grid::-webkit-scrollbar {
      width: 8px;
      height: 8px;
    }

    .cards-vertical-grid::-webkit-scrollbar-track {
      background: #f1f1f1;
      border-radius: 8px;
    }

    .cards-vertical-grid::-webkit-scrollbar-thumb {
      background: #007b5e;
      border-radius: 8px;
      border: 2px solid #f1f1f1;
    }

    .cards-vertical-grid::-webkit-scrollbar-thumb:hover {
      background: #005f4a;
    }

    .dark-mode .cards-vertical-grid::-webkit-scrollbar-track {
      background: #2c2c2c;
    }

    .dark-mode .cards-vertical-grid::-webkit-scrollbar-thumb {
      background: #0c8;
      border: 2px solid #2c2c2c;
    }

    .dark-mode .cards-vertical-grid::-webkit-scrollbar-thumb:hover {
      background: #0a6;
    }

    /* Firefox for cards vertical grid */
    .cards-vertical-grid {
      scrollbar-width: thin;
      scrollbar-color: #007b5e #f1f1f1;
    }

    .dark-mode .cards-vertical-grid {
      scrollbar-color: #0c8 #2c2c2c;
    }

    /* Responsive breakpoints for card grid */
    @media (min-width: 1600px) {
      .cards-vertical-grid {
        grid-template-columns: repeat(auto-fill, minmax(clamp(160px, 12vw, 200px), 1fr));
        gap: 1.5rem;
      }
    }

    @media (max-width: 1200px) {
      .cards-vertical-grid {
        grid-template-columns: repeat(auto-fill, minmax(clamp(110px, 14vw, 160px), 1fr));
        gap: 0.9rem;
      }
    }

    @media (max-width: 992px) {
      .cards-vertical-grid {
        max-height: 60vh;
        grid-template-columns: repeat(auto-fill, minmax(clamp(100px, 16vw, 150px), 1fr));
        gap: 0.8rem;
        padding: 0.8rem;
      }
    }

    @media (max-width: 768px) {
      .cards-vertical-grid {
        max-height: none;
        overflow-y: visible;
        grid-template-columns: repeat(auto-fill, minmax(clamp(90px, 18vw, 140px), 1fr));
        gap: 0.7rem;
        padding: 0.6rem;
      }
    }

    @media (max-width: 480px) {
      .cards-vertical-grid {
        grid-template-columns: repeat(auto-fill, minmax(clamp(80px, 22vw, 130px), 1fr));
        gap: 0.6rem;
        padding: 0.4rem;
      }
    }

    @media (max-width: 360px) {
      .cards-vertical-grid {
        grid-template-columns: repeat(auto-fill, minmax(clamp(70px, 28vw, 120px), 1fr));
        gap: 0.5rem;
        padding: 0.3rem;
      }
    }

    /* Card styles with fluid sizing */
    .card {
      width: 100%;
      aspect-ratio: 2/3;
      background: #333;
      border-radius: clamp(10px, 2vw, 16px);
      overflow: hidden;
      position: relative;
      cursor: pointer;
      color: #fff;
      transition: all 0.3s cubic-bezier(0.4,0,0.2,1);
      box-shadow: 0 6px 12px rgba(0,0,0,0.15);
      transform-origin: center;
      border: 1px solid rgba(255,255,255,0.1);
      display: flex;
      flex-direction: column;
    }
    
    .card:hover {
      transform: translateY(-8px) scale(1.03);
      box-shadow: 0 16px 32px rgba(0,0,0,0.25);
      border-color: rgba(0,123,94,0.3);
    }
    .card img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: transform 0.4s;
    }
    .card:hover img { transform: scale(1.08); filter: brightness(0.6); }

    .card .icons {
      position: absolute;
      top: clamp(0.3rem, 2vw, 0.6rem);
      right: clamp(0.3rem, 2vw, 0.6rem);
      display: flex;
      gap: clamp(0.3rem, 1.5vw, 0.6rem);
      z-index: 10;
      opacity: 0.9;
    }
    .favorite-icon, .bookmark-icon {
      width: clamp(24px, 6vw, 32px);
      height: clamp(24px, 6vw, 32px);
      background: rgba(0,0,0,0.5);
      backdrop-filter: blur(2px);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: 0.2s;
      padding: clamp(4px, 1vw, 6px);
    }
    .favorite-icon svg, .bookmark-icon svg {
      width: clamp(16px, 4vw, 22px);
      height: clamp(16px, 4vw, 22px);
    }
    .favorite-icon:hover, .bookmark-icon:hover {
      transform: scale(1.2);
      background: rgba(0,123,94,0.8);
    }
    .dark-mode .favorite-icon:hover, .dark-mode .bookmark-icon:hover {
      background: #0c8c;
    }

    .card .overlay {
      position: absolute;
      bottom: 0;
      left: 0;
      width: 100%;
      background: linear-gradient(to top, rgba(0,0,0,0.95) 0%, rgba(0,0,0,0.7) 60%, transparent);
      padding: clamp(0.8rem, 4vw, 1.5rem) clamp(0.5rem, 2vw, 1rem) clamp(0.5rem, 2vw, 1rem);
      color: #fff;
      transition: 0.3s;
      height: 40%;
      display: flex;
      flex-direction: column;
      justify-content: flex-end;
    }
    .card:hover .overlay {
      background: linear-gradient(to top, rgba(0,123,94,0.98), rgba(0,123,94,0.8), transparent);
      height: 60%;
    }
    .dark-mode .card:hover .overlay {
      background: linear-gradient(to top, #0c8e, #0c8c, transparent);
    }
    .card .overlay .surah-number {
      font-size: clamp(0.8rem, 3vw, 1.1rem);
      font-weight: bold;
      display: block;
    }
    .card .overlay .surah-name {
      font-size: clamp(0.75rem, 2.5vw, 1rem);
      margin-top: 0.2rem;
    }
    .card .overlay .ayah-count {
      font-size: clamp(0.7rem, 2vw, 0.9rem);
      opacity: 0.9;
    }
    .additional-details {
      max-height: 0;
      opacity: 0;
      overflow: hidden;
      transition: 0.3s;
    }
    .card:hover .additional-details {
      max-height: 80px;
      opacity: 1;
      margin-top: 0.6rem;
      border-top: 1px solid rgba(255,255,255,0.3);
    }
    .quick-actions {
      display: flex;
      justify-content: center;
      gap: 1rem;
      margin-top: 0.8rem;
      opacity: 0;
      transform: translateY(8px);
      transition: 0.3s;
    }
    .card:hover .quick-actions { opacity: 1; transform: translateY(0); }
    .quick-actions button {
      background: rgba(255,255,255,0.9);
      border: none;
      border-radius: 30px;
      padding: clamp(0.2rem, 1.5vw, 0.4rem) clamp(0.5rem, 2vw, 1rem);
      font-weight: 600;
      font-size: clamp(0.7rem, 2.5vw, 0.9rem);
      color: #007b5e;
      cursor: pointer;
      transition: 0.2s;
      white-space: nowrap;
    }
    .quick-actions button:hover { background: #fff; transform: scale(1.05); }

    /* Horizontal scrolling cards container */
    .horizontal-cards-container {
      width: 100%;
      overflow-x: auto;
      padding: 1rem 0;
      margin-bottom: 1.5rem;
      -webkit-overflow-scrolling: touch;
    }
    
    /* Horizontal scrolling cards - fluid and responsive */
    .horizontal-cards {
      display: flex;
      gap: clamp(0.8rem, 2vw, 1.2rem);
      padding: 0.5rem 0.2rem;
      width: max-content;
      min-width: 100%;
    }
    
    /* Fluid cards inside horizontal scrolling containers */
    .horizontal-cards .card {
      flex: 0 0 clamp(140px, 25vw, 200px);
      width: clamp(140px, 25vw, 200px);
      aspect-ratio: 2/3;
    }

    /* Horizontal cards scroll bar */
    .horizontal-cards-container::-webkit-scrollbar {
      height: 8px;
      width: 8px;
    }

    .horizontal-cards-container::-webkit-scrollbar-track {
      background: #f1f1f1;
      border-radius: 8px;
    }

    .horizontal-cards-container::-webkit-scrollbar-thumb {
      background: #007b5e;
      border-radius: 8px;
      border: 2px solid #f1f1f1;
    }

    .horizontal-cards-container::-webkit-scrollbar-thumb:hover {
      background: #005f4a;
    }

    .dark-mode .horizontal-cards-container::-webkit-scrollbar-track {
      background: #2c2c2c;
    }

    .dark-mode .horizontal-cards-container::-webkit-scrollbar-thumb {
      background: #0c8;
      border: 2px solid #2c2c2c;
    }

    .dark-mode .horizontal-cards-container::-webkit-scrollbar-thumb:hover {
      background: #0a6;
    }

    /* Firefox for horizontal cards */
    .horizontal-cards-container {
      scrollbar-width: thin;
      scrollbar-color: #007b5e #f1f1f1;
    }

    .dark-mode .horizontal-cards-container {
      scrollbar-color: #0c8 #2c2c2c;
    }

    /* Horizontal Cards Hover Animation */
    .horizontal-cards .card {
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }
    .horizontal-cards .card:hover {
      transform: translateY(-8px) scale(1.03);
      box-shadow: 0 16px 32px rgba(0, 0, 0, 0.25);
      border-color: rgba(0, 123, 94, 0.3);
    }
    .horizontal-cards .card img {
      transition: transform 0.4s;
    }
    .horizontal-cards .card:hover img {
      transform: scale(1.08);
      filter: brightness(0.6);
    }
    .horizontal-cards .card .overlay {
      transition: all 0.3s;
    }
    .horizontal-cards .card:hover .overlay {
      background: linear-gradient(to top, rgba(0, 123, 94, 0.98), rgba(0, 123, 94, 0.8), transparent);
      height: 60%;
    }

    /* Section titles for My Hadiths tab */
    .my-hadiths-section-title {
      margin: 2rem 0 0.5rem;
      text-align: center;
      font-size: clamp(1.1rem, 4vw, 1.5rem);
      color: #007b5e;
    }
    
    .dark-mode .my-hadiths-section-title {
      color: #0c8;
    }

    /* ---------- AYAH CARD (for My Hadiths) - UNCHANGED ---------- */
    .ayah-card {
      flex: 0 0 auto;
      width: 300px;
      background: linear-gradient(145deg, #2e5c4a, #1e3a30);
      border-radius: 20px;
      padding: 1.5rem;
      color: white;
      position: relative;
      box-shadow: 0 10px 20px rgba(0,0,0,0.3);
      border: 1px solid #0c8;
    }

    /* Ayah Card Hover Animation (My Hadiths) */
    .ayah-card {
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }
    .ayah-card:hover {
      transform: translateY(-8px) scale(1.03);
      box-shadow: 0 16px 32px rgba(0, 0, 0, 0.25);
      border-color: rgba(0, 200, 136, 0.5);
    }

    .ayah-card .hadith-number {
      background: #0c8;
      display: inline-block;
      padding: 0.2rem 1rem;
      border-radius: 40px;
      font-weight: bold;
      margin-bottom: 1rem;
    }
    .ayah-card .hadith-text {
      font-family: 'Noto Naskh Arabic', serif;
      font-size: 1.2rem;
      direction: rtl;
      text-align: right;
      max-height: 100px;
      overflow: hidden;
      margin-bottom: 1rem;
    }
    .ayah-card button {
      background: #fff;
      color: #1e3a30;
      border: none;
      padding: 0.4rem 1rem;
      border-radius: 30px;
      font-weight: 600;
      cursor: pointer;
    }
    .ayah-card:hover {
      cursor: pointer;
    }

    /* ---------- MODAL & CAROUSEL (fully styled) ---------- */
    .modal {
      display: none;
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0,0,0,0.7);
      backdrop-filter: blur(6px);
      align-items: center;
      justify-content: center;
      z-index: 20000;
      animation: fadeIn 0.3s;
    }
    .modal.show { display: flex; }
    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    .modal-content {
      background: white;
      max-width: 1000px;
      width: 95%;
      max-height: 90vh;
      overflow-y: auto;
      border-radius: 24px;
      padding: 2rem;
      position: relative;
      box-shadow: 0 20px 40px rgba(0,0,0,0.3);
      animation: slideUp 0.3s;
    }

    /* Modal content scroll bar */
    .modal-content::-webkit-scrollbar {
      width: 8px;
      height: 8px;
    }

    .modal-content::-webkit-scrollbar-track {
      background: #f1f1f1;
      border-radius: 10px;
    }

    .modal-content::-webkit-scrollbar-thumb {
      background: #007b5e;
      border-radius: 10px;
      border: 2px solid #f1f1f1;
    }

    .modal-content::-webkit-scrollbar-thumb:hover {
      background: #005f4a;
    }

    .dark-mode .modal-content::-webkit-scrollbar-track {
      background: #2c2c2c;
    }

    .dark-mode .modal-content::-webkit-scrollbar-thumb {
      background: #0c8;
      border: 2px solid #2c2c2c;
    }

    .dark-mode .modal-content::-webkit-scrollbar-thumb:hover {
      background: #0a6;
    }

    /* Firefox for modal content */
    .modal-content {
      scrollbar-width: thin;
      scrollbar-color: #007b5e #f1f1f1;
    }

    .dark-mode .modal-content {
      scrollbar-color: #0c8 #2c2c2c;
    }

    @keyframes slideUp { from { transform: translateY(30px); opacity:0; } to { transform: translateY(0); opacity:1; } }
    .dark-mode .modal-content { background: #1f2a2a; color: #eee; }

    .hadith-info { text-align: center; margin-bottom: 1.5rem; }
    .hadith-info h1 { color: #007b5e; }
    .dark-mode .hadith-info h1 { color: #0c8; }

    .tabs { display: flex; justify-content: center; gap: 1rem; margin: 1.5rem 0; }
    .tab-button {
      padding: 0.6rem 1.8rem;
      border: none;
      border-radius: 40px;
      background: #ddd;
      font-weight: bold;
      cursor: pointer;
      transition: 0.3s;
    }
    .tab-button.active { background: #007b5e; color: white; }
    .dark-mode .tab-button { background: #444; color: #ddd; }
    .dark-mode .tab-button.active { background: #0c8; }

    /* carousel container */
    .carousel-container { max-width: 900px; margin: 0 auto; }
    .carousel-hadith {
      background: #fff;
      border-radius: 24px;
      padding: 2.5rem;
      padding-top: 4rem;
      box-shadow: 0 8px 24px rgba(0,0,0,0.12);
      border: 1px solid #e0e0e0;
      position: relative;
      margin-bottom: 1.5rem;
    }
    .dark-mode .carousel-hadith { background: #2a3636; border-color: #3a4a4a; }
    .carousel-hadith .hadith-number {
      position: absolute;
      top: 1.2rem; 
      right: 1rem;
      left: 1rem;
      background: rgba(0,123,94,0.15);
      color: #007b5e;
      padding: 0.4rem 1.2rem;
      border-radius: 10px;
      font-weight: 700;
    }

    .arabic {
      font-family: 'Noto Naskh Arabic', serif;
    }
    .dark-mode .carousel-hadith .hadith-number { background: #0c82; color: #0c8; }
    .carousel-hadith .arabic {
      font-family: 'Noto Naskh Arabic', serif;
      font-size: 1.5rem;
      direction: rtl;
      text-align: justify;
      line-height: 1.9;
      margin: 2rem 0 1.5rem;
      /* color: #1a2c2c; */
    }
    .dark-mode .carousel-hadith .arabic { color: #f0f0f0; }
    .carousel-hadith .translation {
      font-size: 1.1rem;
      line-height: 1.7;
      color: #3a4a4a;
      margin-bottom: 1.2rem;
      text-align: justify;
    }
    .dark-mode .carousel-hadith .translation { color: #ccc; }
    .carousel-hadith .translation.ur {
      font-family: 'Jameel Noori Nastaleeq', 'Noto Nastaliq Urdu', serif;
      font-size: 1.2rem;
      line-height: 2.4;
      direction: rtl;
      text-align: justify;
    }
    .carousel-hadith .hadith-meta {
      font-size: 0.95rem;
      color: #5a6a6a;
      text-align: center;
      margin-top: 1rem;
    }
    .dark-mode .carousel-hadith .hadith-meta { color: #aab; }

    /* action buttons inside carousel */
    .hadith-actions {
      display: flex;
      justify-content: center;
      gap: 1.2rem;
      margin-top: 2rem;
      padding-top: 1.5rem;
      border-top: 2px solid #e4e4e4;
    }
    .dark-mode .hadith-actions { border-top-color: #3a4a4a; }
    .action-button {
      width: 54px;
      height: 54px;
      border-radius: 50%;
      background: #f5f7fa;
      border: 1px solid #cbd5e0;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: 0.25s;
    }
    .action-button:hover {
      background: #e2e8f0;
      transform: scale(1.1);
      box-shadow: 0 6px 14px rgba(0,123,94,0.25);
    }
    .dark-mode .action-button {
      background: #3a4e4e;
      border-color: #0c8;
    }
    .dark-mode .action-button:hover { background: #4e6b6b; }
    .action-button svg {
      width: 28px;
      height: 28px;
      stroke: #007b5e;
      fill: none;
      transition: 0.2s;
    }
    .dark-mode .action-button svg { stroke: #0c8; }
    .action-button.favorited svg { fill: #007b5e; stroke: #007b5e; }
    .dark-mode .action-button.favorited svg { fill: #0c8; stroke: #0c8; }
    .action-button.bookmarked svg { fill: #007b5e; stroke: #007b5e; }
    .dark-mode .action-button.bookmarked svg { fill: #0c8; stroke: #0c8; }
    
    /* ===== HADITH NAVIGATION BUTTONS STYLING ===== */
    .nav-buttons {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 2rem;
      padding: 1rem 0.5rem;
      gap: 1rem;
    }
    .nav-buttons button {
      padding: 0.75rem 1.8rem;
      background: linear-gradient(135deg, #007b5e 0%, #009f7a 100%);
      color: white;
      border: none;
      border-radius: 50px;
      font-weight: 700;
      font-size: 0.95rem;
      cursor: pointer;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      box-shadow: 0 4px 15px rgba(0, 123, 94, 0.3);
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    .nav-buttons button:hover:not(:disabled) {
      background: linear-gradient(135deg, #005f4a 0%, #007b5e 100%);
      transform: translateY(-2px) scale(1.02);
      box-shadow: 0 6px 20px rgba(0, 123, 94, 0.4);
    }
    .nav-buttons button:active:not(:disabled) {
      transform: translateY(0) scale(0.98);
    }
    .nav-buttons button:disabled {
      background: linear-gradient(135deg, #b0b0b0 0%, #d0d0d0 100%);
      color: #888;
      cursor: not-allowed;
      box-shadow: none;
    }
    .nav-buttons button:disabled:hover {
      transform: none;
      box-shadow: none;
    }
    .dark-mode .nav-buttons button {
      background: linear-gradient(135deg, #0c8 0%, #00d9a5 100%);
      box-shadow: 0 4px 15px rgba(0, 200, 136, 0.3);
    }
    .dark-mode .nav-buttons button:hover:not(:disabled) {
      background: linear-gradient(135deg, #0a6 0%, #0c8 100%);
      box-shadow: 0 6px 20px rgba(0, 200, 136, 0.4);
    }
    .dark-mode .nav-buttons button:disabled {
      background: linear-gradient(135deg, #444 0%, #555 100%);
      color: #777;
    }
    .nav-buttons button svg {
      width: 18px;
      height: 18px;
      fill: currentColor;
    }
    .nav-buttons button.nav-btn {
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    .nav-buttons button.nav-btn span {
      white-space: nowrap;
    }
    
    /* Mobile responsive styles for nav buttons */
    @media (max-width: 480px) {
      .nav-buttons {
        flex-direction: row;
        justify-content: space-between;
        padding: 0.8rem 0.25rem;
        gap: 0.5rem;
      }
      .nav-buttons button {
        padding: 0.6rem 1rem;
        font-size: 0.8rem;
      }
      .nav-buttons button.nav-btn span {
        display: none;
      }
      .nav-buttons button.nav-btn svg {
        width: 20px;
        height: 20px;
      }
      .carousel-counter {
        font-weight: 700;
        color: #007b5e;
        font-size: 1.2rem;
      }
      .dark-mode .carousel-counter { color: #8ff; }
    }
    
    /* ---------- LANGUAGE SELECT (styled) ---------- */
    .carousel-lang-select {
      background: #f1f5f9;
      padding: 1rem;
      border-radius: 60px;
      text-align: center;
      margin-bottom: 1.8rem;
      border: 1px solid #cbd5e0;
    }
    .dark-mode .carousel-lang-select { background: #2a3a3a; border-color: #0c8; }
    .carousel-lang-select label {
      font-weight: 600;
      margin-right: 0.8rem;
      color: #1a2c2c;
    }
    .dark-mode .carousel-lang-select label { color: #e0f0f0; }
    .carousel-lang-select select {
      padding: 0.6rem 2.2rem 0.6rem 1.2rem;
      border: 2px solid #007b5e;
      border-radius: 40px;
      background: white;
      font-size: 1rem;
      appearance: none;
      background-image: url('data:image/svg+xml;utf8,<svg fill="%23007b5e" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="20" height="20"><path d="M7 10l5 5 5-5z"/></svg>');
      background-repeat: no-repeat;
      background-position: right 0.8rem center;
      cursor: pointer;
    }

    /* Select dropdown scroll bar */
    select::-webkit-scrollbar {
      width: 8px;
      height: 8px;
    }

    select::-webkit-scrollbar-track {
      background: #f1f1f1;
      border-radius: 8px;
    }

    select::-webkit-scrollbar-thumb {
      background: #007b5e;
      border-radius: 8px;
      border: 2px solid #f1f1f1;
    }

    select::-webkit-scrollbar-thumb:hover {
      background: #005f4a;
    }

    .dark-mode select::-webkit-scrollbar-track {
      background: #2c2c2c;
    }

    .dark-mode select::-webkit-scrollbar-thumb {
      background: #0c8;
      border: 2px solid #2c2c2c;
    }

    .dark-mode select::-webkit-scrollbar-thumb:hover {
      background: #0a6;
    }

    /* Firefox for selects */
    select {
      scrollbar-width: thin;
      scrollbar-color: #007b5e #f1f1f1;
    }

    .dark-mode select {
      scrollbar-color: #0c8 #2c2c2c;
    }

    .dark-mode .carousel-lang-select select {
      background-color: #1f2a2a;
      border-color: #0c8;
      color: #eee;
      background-image: url('data:image/svg+xml;utf8,<svg fill="%230c8" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="20" height="20"><path d="M7 10l5 5 5-5z"/></svg>');
    }
    .carousel-lang-select select:hover { border-color: #005f4a; transform: scale(1.02); }

    /* ---------- GO TO HADITH ---------- */
    .go-to-hadith { text-align: center; margin: 1.5rem 0; }
    .go-to-hadith input {
      padding: 0.6rem;
      width: 90px;
      border: 2px solid #007b5e;
      border-radius: 12px;
      font-size: 1rem;
      text-align: center;
    }
    .go-to-hadith button {
      padding: 0.6rem 1.4rem;
      background: #007b5e;
      color: white;
      border: none;
      border-radius: 30px;
      margin-left: 0.5rem;
      font-weight: 600;
      cursor: pointer;
    }

    .dark-mode .go-to-hadith input{
      background: #1f2a2a;
      color: white;
    }

    /* ---------- SHARE MODAL (exact style from request) ---------- */
    #share-modal.modal {
      display: none;
    }
    #share-modal.modal.show {
      display: flex;
    }
    #share-modal .modal-content {
      background: white;
      padding: 30px;
      border-radius: 20px;
      text-align: center;
      max-width: 500px;
    }
    .dark-mode #share-modal .modal-content { background: #2c2c2c; }
    #share-modal h2 { margin-bottom: 1.5rem; color: #007b5e; }
    .dark-mode #share-modal h2 { color: #0c8; }
    #share-modal div { margin-bottom: 1rem; text-align: left; }
    #share-modal label {
      display: flex;
      align-items: center;
      font-weight: 600;
      cursor: pointer;
    }
    #share-modal input[type="checkbox"] {
      margin-right: 0.8rem;
      width: 20px;
      height: 20px;
      border: 2px solid #007b5e;
      border-radius: 6px;
      appearance: none;
      background: white;
      transition: 0.2s;
    }
    #share-modal input[type="checkbox"]:checked {
      background: #007b5e;
      background-image: url('data:image/svg+xml;utf8,<svg fill="%23fff" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="14" height="14"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/></svg>');
      background-repeat: no-repeat;
      background-position: center;
    }
    .dark-mode #share-modal input[type="checkbox"] {
      background: #2c2c2c;
      border-color: #0c8;
    }
    .dark-mode #share-modal input[type="checkbox"]:checked { background: #0c8; }
    #share-modal select {
      padding: 0.6rem 2rem 0.6rem 1rem;
      border: 2px solid #007b5e;
      border-radius: 30px;
      background: white;
      font-size: 1rem;
      appearance: none;
      background-image: url('data:image/svg+xml;utf8,<svg fill="%23007b5e" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="18" height="18"><path d="M7 10l5 5 5-5z"/></svg>');
      background-repeat: no-repeat;
      background-position: right 0.8rem center;
    }
    .dark-mode #share-modal select { background-color: #2c2c2c; border-color: #0c8; color: #eee; background-image: url('data:image/svg+xml;utf8,<svg fill="%230c8" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="18" height="18"><path d="M7 10l5 5 5-5z"/></svg>'); }
    #share-modal button {
      margin: 0.5rem;
      padding: 0.7rem 1.8rem;
      background: #007b5e;
      color: white;
      border: none;
      border-radius: 40px;
      font-weight: 600;
      cursor: pointer;
      transition: 0.2s;
    }
    #share-modal button:hover { background: #005f4a; transform: scale(1.02); }
    .dark-mode #share-modal button { background: #0c8; }
    .dark-mode #share-modal button:hover { background: #0a6; }
    #copy-message { color: #0c8; font-weight: bold; margin-top: 1rem; }

    /* ---------- SCROLL TO TOP ---------- */
    #scrollToTop {
      position: fixed; bottom: 30px; right: 30px;
      width: 55px; height: 55px;
      background: #007b5e; color: white;
      border: none; border-radius: 50%;
      font-size: 26px;
      cursor: pointer;
      display: none;
      align-items: center; justify-content: center;
      box-shadow: 0 6px 16px rgba(0,0,0,0.3);
      z-index: 3000;
      transition: 0.25s;
    }
    #scrollToTop.show { display: flex; }
    #scrollToTop:hover { background: #005f4a; transform: scale(1.1); }
    .dark-mode #scrollToTop { background: #0c8; }

    /* Textarea scroll bars (if any) */
    textarea::-webkit-scrollbar {
      width: 8px;
      height: 8px;
    }

    textarea::-webkit-scrollbar-track {
      background: #f1f1f1;
      border-radius: 8px;
    }

    textarea::-webkit-scrollbar-thumb {
      background: #007b5e;
      border-radius: 8px;
      border: 2px solid #f1f1f1;
    }

    textarea::-webkit-scrollbar-thumb:hover {
      background: #005f4a;
    }

    .dark-mode textarea::-webkit-scrollbar-track {
      background: #2c2c2c;
    }

    .dark-mode textarea::-webkit-scrollbar-thumb {
      background: #0c8;
      border: 2px solid #2c2c2c;
    }

    .dark-mode textarea::-webkit-scrollbar-thumb:hover {
      background: #0a6;
    }

    /* Firefox for textareas */
    textarea {
      scrollbar-width: thin;
      scrollbar-color: #007b5e #f1f1f1;
    }

    .dark-mode textarea {
      scrollbar-color: #0c8 #2c2c2c;
    }

    /* ============================================
       RESPONSIVE STYLES FOR ALL SCREENS
       ============================================ */

    /* Tablet Styles (max-width: 992px) */
    @media (max-width: 992px) {
      .container {
        padding: 1.5rem 0.8rem;
      }
      .modal-content {
        width: 90%;
        padding: 1.5rem;
      }
      .carousel-hadith {
        padding: 2rem 1.5rem;
        padding-top: 3rem;
      }
      .carousel-hadith .arabic {
        font-size: 1.3rem;
      }
      .hadith-actions {
        gap: 0.8rem;
      }
      .action-button {
        width: 48px;
        height: 48px;
      }
      
      /* Responsive horizontal cards */
      .horizontal-cards .card {
        flex: 0 0 clamp(130px, 22vw, 180px);
        width: clamp(130px, 22vw, 180px);
      }
    }

    /* Mobile Styles (max-width: 600px) */
    @media (max-width: 600px) {
      .navbar h1 {
        font-size: 1.25rem;
      }

      .nav-links {
        display: none;
        flex-direction: column;
        width: 100%;
        background-color: #f0f0f0;
        position: absolute;
        top: 60px;
        left: 0;
        padding: 1rem;
        box-shadow: 0 4px 6px rgba(0,0,0,0.1);
      }

      .dark-mode .nav-links {
        background-color: #2c2c2c;
      }

      .nav-links.active {
        display: flex;
      }

      .nav-links a {
        margin: 0.5rem 0;
      }

      .theme-toggle {
        margin: 0;
      }

      .menu-toggle {
        display: block;
      }
    }

    /* Tablet Styles (max-width: 768px) */
    @media (max-width: 768px) {
      /* Responsive adjustments for scroll bars */
      ::-webkit-scrollbar {
        width: 6px;
        height: 6px;
      }
      
      body::-webkit-scrollbar {
        width: 8px;
        height: 8px;
      }
      
      body::-webkit-scrollbar-thumb {
        border-width: 2px;
      }

      .container {
        padding: 1rem 0.5rem;
      }
      h1 .arabic {
        font-size: 1.2rem;
      }
      .description {
        font-size: 0.9rem;
        padding: 0 0.5rem;
      }
      
      /* Modal responsive */
      .modal-content {
        width: 95%;
        max-height: 85vh;
        padding: 1rem;
        border-radius: 16px;
        margin: 0.5rem;
      }
      .hadith-info h1 {
        font-size: 1.3rem;
      }
      .hadith-info p {
        font-size: 0.85rem;
      }
      /* Carousel responsive */
      .carousel-container {
        max-width: 100%;
      }
      .carousel-hadith {
        padding: 1.5rem 1rem;
        padding-top: 2.5rem;
        border-radius: 16px;
      }
      .carousel-hadith .hadith-number {
        top: 0.8rem;
        right: 1rem;
        padding: 0.3rem 0.8rem;
        font-size: 0.85rem;
      }
      .carousel-hadith .arabic {
        font-size: 1.1rem;
        line-height: 1.7;
        margin: 2rem 0 1rem;
      }
      .carousel-hadith .translation {
        font-size: 0.95rem;
        line-height: 1.5;
      }
      .carousel-hadith .translation.ur {
        font-size: 1rem;
        line-height: 1.8;
      }
      .carousel-hadith .hadith-meta {
        font-size: 0.8rem;
        margin-top: 0.8rem;
      }
      /* Hadith actions */
      .hadith-actions {
        gap: 0.6rem;
        margin-top: 1.5rem;
        padding-top: 1rem;
        flex-wrap: wrap;
        justify-content: center;
      }
      .action-button {
        width: 44px;
        height: 44px;
      }
      .action-button svg {
        width: 22px;
        height: 22px;
      }
      /* Navigation buttons */
      .nav-buttons {
        flex-wrap: wrap;
        gap: 0.5rem;
        justify-content: center;
      }
      .nav-buttons button {
        padding: 0.5rem 1rem;
        font-size: 0.85rem;
        border-radius: 30px;
      }
      .carousel-counter {
        font-size: 1rem;
        width: 100%;
        text-align: center;
        order: -1;
        margin-bottom: 0.5rem;
      }
      /* Language select */
      .carousel-lang-select {
        padding: 0.8rem;
        border-radius: 30px;
        margin-bottom: 1rem;
      }
      .carousel-lang-select label {
        display: block;
        margin-right: 0;
        margin-bottom: 0.5rem;
        font-size: 0.9rem;
      }
      .carousel-lang-select select {
        width: 100%;
        padding: 0.5rem 2rem 0.5rem 1rem;
        font-size: 0.9rem;
      }
      /* Go to hadith */
      .go-to-hadith {
        margin: 1rem 0;
      }
      .go-to-hadith input {
        width: 70px;
        padding: 0.5rem;
        font-size: 0.9rem;
      }
      .go-to-hadith button {
        padding: 0.5rem 1rem;
        font-size: 0.85rem;
      }
      /* Footer */
      .footer {
        padding: 1.5rem 0.5rem;
        margin-top: 2rem;
        font-size: 0.85rem;
      }
      /* Scroll to top */
      #scrollToTop {
        bottom: 20px;
        right: 20px;
        width: 45px;
        height: 45px;
        font-size: 20px;
      }
      /* For very small screens, ensure minimum touch target size */
      .favorite-icon, .bookmark-icon {
        width: 28px;
        height: 28px;
      }
      
      .favorite-icon svg, .bookmark-icon svg {
        width: 18px;
        height: 18px;
      }
      
      .quick-actions button {
        padding: 0.3rem 0.8rem;
        font-size: 0.75rem;
      }
      
      /* Responsive horizontal cards */
      .horizontal-cards .card {
        flex: 0 0 clamp(120px, 28vw, 160px);
        width: clamp(120px, 28vw, 160px);
      }
    }

    /* Small Mobile Styles (max-width: 480px) */
    @media (max-width: 480px) {
      /* Responsive adjustments for scroll bars */
      ::-webkit-scrollbar {
        width: 4px;
        height: 4px;
      }
      
      body::-webkit-scrollbar {
        width: 6px;
        height: 6px;
      }

      .menu-toggle img {
        width: 20px;
        height: 20px;
      }
      h1 {
        font-size: 1.3rem;
      }
      h1 hr {
        margin: 0.5rem 0;
      }
      h1 .arabic {
        font-size: 1rem;
      }
      .description {
        font-size: 0.85rem;
      }
      
      /* Modal */
      .modal-content {
        width: 98%;
        padding: 0.8rem;
        border-radius: 12px;
      }
      .hadith-info h1 {
        font-size: 1.1rem;
      }
      /* Carousel */
      .carousel-hadith {
        padding: 1.2rem 0.8rem;
        padding-top: 2rem;
      }

      .carousel-hadith .arabic {
        font-size: 1rem;
        margin: 3rem 0 1.5rem;
      }
      .carousel-hadith .translation {
        font-size: 0.9rem;
      }
      .carousel-hadith .translation.ur {
        font-size: 0.95rem;
      }
      .hadith-actions {
        gap: 0.5rem;
      }
      .action-button {
        width: 40px;
        height: 40px;
      }
      .action-button svg {
        width: 20px;
        height: 20px;
      }
      .nav-buttons button {
        padding: 0.4rem 0.8rem;
        font-size: 0.8rem;
      }
      
      /* Responsive horizontal cards */
      .horizontal-cards .card {
        flex: 0 0 clamp(110px, 32vw, 140px);
        width: clamp(110px, 32vw, 140px);
      }
    }

    /* Footer Styles */
    .footer {
      background: linear-gradient(135deg, #f5f7fa 0%, #e4e8ec 100%);
      padding: 3rem 1rem 1.5rem;
      margin-top: 3rem;
      position: relative;
      overflow: hidden;
      transition: all 0.5s ease;
    }

    .footer::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, #007b5e, #00a884, #007b5e);
      background-size: 200% 100%;
      animation: gradientMove 3s ease infinite;
    }

    @keyframes gradientMove {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }

    .dark-mode .footer {
      background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
      color: #e0e0e0;
    }

    .footer-pattern {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-image: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23007b5e' fill-opacity='0.03'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
      opacity: 0.5;
      pointer-events: none;
    }

    .dark-mode .footer-pattern {
      background-image: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%2300a884' fill-opacity='0.08'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
    }

    .footer-content {
      max-width: 1200px;
      margin: auto;
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 2.5rem;
      text-align: center;
      position: relative;
      z-index: 1;
    }

    .footer-section {
      padding: 1.5rem;
      border-radius: 16px;
      background-color: rgba(255, 255, 255, 0.7);
      backdrop-filter: blur(10px);
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
      transition: all 0.3s ease;
      border: 1px solid rgba(255, 255, 255, 0.5);
    }

    .footer-section:hover {
      transform: translateY(-8px);
      box-shadow: 0 12px 30px rgba(0, 0, 0, 0.12);
    }

    .dark-mode .footer-section {
      background-color: rgba(45, 45, 45, 0.7);
      border-color: rgba(255, 255, 255, 0.1);
    }

    .footer-logo-section {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }

    .footer-logo {
      margin-bottom: 1rem;
    }

    .footer-logo img {
      width: 80px;
      height: 80px;
      margin-bottom: 0.5rem;
      transition: all 0.3s ease;
    }

    .footer-logo img:hover {
      transform: scale(1.05);
    }

    .footer-logo h2 {
      margin: 1rem 0 0.5rem;
      font-family: 'Segoe UI', Tahoma, sans-serif;
      font-size: 1.8rem;
      font-weight: bold;
      background: linear-gradient(135deg, #007b5e, #00a884);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .dark-mode .footer-logo h2 {
      background: linear-gradient(135deg, #0c8, #00d9a5);
      -webkit-background-clip: text;
      background-clip: text;
    }

    .footer-tagline {
      font-size: 0.95rem;
      color: #666;
      margin-top: 0.5rem;
      font-style: italic;
      transition: color 0.5s ease;
    }

    .dark-mode .footer-tagline {
      color: #aaa;
    }

    .footer-section-title {
      font-size: 1.3rem;
      margin-bottom: 1.2rem;
      font-family: 'Segoe UI', Tahoma, sans-serif;
      font-weight: 600;
      position: relative;
      padding-bottom: 0.8rem;
      color: #333;
    }

    .dark-mode .footer-section-title {
      color: #e0e0e0;
    }

    .footer-section-title::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 50px;
      height: 3px;
      background: linear-gradient(90deg, #007b5e, #00a884);
      border-radius: 2px;
    }

    .footer-links {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .footer-links li {
      margin: 0.6rem 0;
      position: relative;
    }

    .footer-links a {
      color: inherit;
      text-decoration: none;
      padding: 0.5rem 1rem 0.5rem 1.5rem;
      border-radius: 25px;
      transition: all 0.3s ease;
      display: inline-block;
      position: relative;
      font-weight: 500;
    }

    .footer-links a::before {
      content: '✦';
      position: absolute;
      left: 0;
      top: 50%;
      transform: translateY(-50%);
      color: #007b5e;
      font-size: 0.7rem;
      opacity: 0;
      transition: all 0.3s ease;
    }

    .footer-links a:hover {
      color: #007b5e;
      background-color: rgba(0, 123, 94, 0.1);
      padding-left: 2rem;
    }

    .footer-links a:hover::before {
      opacity: 1;
      left: 0.5rem;
    }

    .dark-mode .footer-links a:hover {
      color: #0c8;
      background-color: rgba(0, 200, 136, 0.1);
    }

    .dark-mode .footer-links a::before {
      color: #0c8;
    }

    .footer-contact {
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    .contact-info {
      width: 100%;
    }

    .email-box {
      background: linear-gradient(135deg, #007b5e, #00a884);
      padding: 1.2rem 1.5rem;
      border-radius: 12px;
      box-shadow: 0 4px 15px rgba(0, 123, 94, 0.25);
      transition: all 0.3s ease;
      margin-top: 1rem;
    }

    .email-box:hover {
      transform: scale(1.02);
      box-shadow: 0 6px 20px rgba(0, 123, 94, 0.35);
    }

    .email-box a {
      color: #fff;
      text-decoration: none;
      font-weight: 500;
      font-size: 0.95rem;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.5rem;
      transition: all 0.3s ease;
      word-break: break-all;
    }

    .email-box a::before {
      content: '✉';
      font-size: 1.1rem;
    }

    .email-box a:hover {
      color: #f0f0f0;
      text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
    }

    /* Social Links Styles */
    .social-links {
      display: flex;
      justify-content: center;
      gap: 1rem;
      margin-top: 1.5rem;
      flex-wrap: wrap;
    }

    .social-link {
      width: 45px;
      height: 45px;
      border-radius: 50%;
      background-color: #fff;
      display: flex;
      align-items: center;
      justify-content: center;
      text-decoration: none;
      box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
      transition: all 0.3s ease;
      border: 2px solid transparent;
      overflow: hidden;
    }

    .social-link:hover {
      transform: translateY(-5px) scale(1.1);
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
    }

    .social-link svg {
      width: 24px;
      height: 24px;
      transition: all 0.3s ease;
    }

    /* Facebook specific styles */
    .social-link.facebook {
      background-color: #fff;
    }

    .social-link.facebook:hover {
      background-color: #395398;
    }

    .social-link.facebook:hover svg .cls-2 {
      fill: #fff;
    }

    /* Twitter specific styles */
    .social-link.twitter {
      background-color: #fff;
    }

    .social-link.twitter:hover {
      background-color: #111;
    }

    /* Instagram specific styles */
    .social-link.instagram {
      background-color: #fff;
    }

    .social-link.instagram:hover {
      background-color: #e4405f;
    }

    .social-link.instagram:hover svg path:not([fill="url(#instagram-gradient)"]):not([fill="url(#instagram-gradient2)"]) {
      fill: #fff;
    }

    /* YouTube specific styles */
    .social-link.youtube {
      background-color: #fff;
    }

    .social-link.youtube:hover {
      background-color: #e52929;
    }

    /* For dark mode */
    .dark-mode .social-link {
      background-color: #2c2c2c;
    }

    .dark-mode .social-link.facebook {
      background-color: #2c2c2c;
    }

    .dark-mode .social-link.facebook:hover {
      background-color: #395398;
    }

    .dark-mode .social-link.twitter {
      background-color: #2c2c2c;
    }

    .dark-mode .social-link.twitter:hover {
      background-color: #111;
    }

    .dark-mode .social-link.instagram {
      background-color: #2c2c2c;
    }

    .dark-mode .social-link.instagram:hover {
      background-color: #e4405f;
    }

    .dark-mode .social-link.instagram:hover svg path:not([fill="url(#instagram-gradient)"]):not([fill="url(#instagram-gradient2)"]) {
      fill: #fff;
    }

    .dark-mode .social-link.youtube {
      background-color: #2c2c2c;
    }

    .dark-mode .social-link.youtube:hover {
      background-color: #e52929;
    }

    .footer-bottom {
      text-align: center;
      padding-top: 2rem;
      margin-top: 2rem;
      border-top: 2px dashed rgba(0, 123, 94, 0.2);
      font-size: 0.95rem;
      color: #666;
      transition: all 0.5s ease;
      position: relative;
      z-index: 1;
    }

    .dark-mode .footer-bottom {
      color: #aaa;
      border-top-color: rgba(0, 200, 136, 0.2);
    }

    .footer-bottom p {
      margin: 0.5rem 0;
    }

    .footer-bottom a {
      color: #007b5e;
      text-decoration: none;
      font-weight: 500;
      transition: all 0.3s ease;
    }

    .footer-bottom a:hover {
      color: #00a884;
      text-decoration: underline;
    }

    .dark-mode .footer-bottom a {
      color: #0c8;
    }

    .dark-mode .footer-bottom a:hover {
      color: #00d9a5;
    }

    .bismillah {
      font-family: 'Noto Naskh Arabic', serif;
      font-size: 1.2rem;
      color: #007b5e;
      margin-bottom: 1rem;
      transition: color 0.5s ease;
    }

    .dark-mode .bismillah {
      color: #0c8;
    }

    /* Footer Responsive Styles */
    
    /* Large Desktop (1200px and up) */
    @media (min-width: 1200px) {
      .footer-content {
        gap: 3rem;
      }
      
      .footer-section {
        padding: 2rem;
      }
      
      .footer-logo img {
        width: 90px;
        height: 90px;
      }
    }

    /* Desktop (992px - 1199px) */
    @media (max-width: 1199px) {
      .footer-content {
        gap: 2rem;
      }
      
      .footer-section {
        padding: 1.5rem;
      }
      
      .footer-logo img {
        width: 80px;
        height: 80px;
      }
    }

    /* Tablet Landscape (992px - 1199px) */
    @media (max-width: 992px) {
      .footer-content {
        grid-template-columns: repeat(2, 1fr);
        gap: 1.5rem;
      }

      .footer-section {
        padding: 1.3rem;
      }

      .footer-logo-section {
        grid-column: 1 / -1;
        order: -1;
      }

      .footer-links-section {
        order: 1;
      }

      .footer-contact {
        order: 2;
      }

      .footer-bottom {
        padding-top: 1.5rem;
        margin-top: 1.5rem;
      }
    }

    /* Tablet Portrait (768px - 991px) */
    @media (max-width: 991px) {
      .footer {
        padding: 2.5rem 1.5rem 1.5rem;
      }

      .footer-content {
        gap: 1.25rem;
      }

      .footer-section {
        padding: 1.25rem;
      }

      .footer-logo h2 {
        font-size: 1.7rem;
      }

      .footer-section-title {
        font-size: 1.2rem;
      }
    }

    /* Tablet (768px) */
    @media (max-width: 768px) {
      .footer-content {
        grid-template-columns: 1fr;
        gap: 1.25rem;
      }

      .footer-section {
        padding: 1.2rem;
      }

      .footer-logo-section {
        order: -1;
      }

      .footer-links-section {
        order: 1;
      }

      .footer-contact {
        order: 2;
      }

      .email-box {
        padding: 1rem 1.2rem;
      }

      .email-box a {
        font-size: 0.9rem;
      }
    }

    /* Large Mobile (576px - 767px) */
    @media (max-width: 576px) {
      .footer {
        padding: 2rem 1rem 1rem;
      }

      .footer-content {
        gap: 1rem;
      }

      .footer-section {
        padding: 1rem;
        border-radius: 12px;
      }

      .footer-logo img {
        width: 70px;
        height: 70px;
      }

      .footer-logo h2 {
        font-size: 1.5rem;
      }

      .footer-tagline {
        font-size: 0.9rem;
      }

      .footer-section-title {
        font-size: 1.15rem;
        margin-bottom: 1rem;
        padding-bottom: 0.6rem;
      }

      .footer-section-title::after {
        width: 40px;
        height: 2px;
      }

      .footer-links {
        display: flex;
        flex-direction: column;
        align-items: center;
      }

      .footer-links li {
        margin: 0.4rem 0;
      }

      .footer-links a {
        padding: 0.4rem 1rem 0.4rem 1.5rem;
        font-size: 0.95rem;
      }

      .social-links {
        gap: 0.8rem;
      }

      .social-link {
        width: 42px;
        height: 42px;
      }

      .social-link svg {
        width: 22px;
        height: 22px;
      }

      .email-box {
        padding: 1rem;
        border-radius: 10px;
      }

      .email-box a {
        font-size: 0.85rem;
        flex-direction: column;
        gap: 0.3rem;
      }

      .email-box a::before {
        font-size: 1rem;
      }

      .footer-bottom {
        padding-top: 1.25rem;
        margin-top: 1.25rem;
        font-size: 0.85rem;
      }
    }

    /* Medium Mobile (480px) */
    @media (max-width: 480px) {
      .footer {
        padding: 1.75rem 0.75rem 0.75rem;
      }

      .footer-section {
        padding: 0.9rem;
        border-radius: 10px;
      }

      .footer-logo img {
        width: 65px;
        height: 65px;
      }

      .footer-logo h2 {
        font-size: 1.4rem;
      }

      .footer-tagline {
        font-size: 0.85rem;
      }

      .bismillah {
        font-size: 1.1rem;
      }

      .footer-section-title {
        font-size: 1.1rem;
      }

      .footer-links a {
        padding: 0.35rem 0.8rem 0.35rem 1.3rem;
        font-size: 0.9rem;
      }

      .footer-links a:hover {
        padding-left: 1.5rem;
      }

      .social-link {
        width: 40px;
        height: 40px;
      }

      .social-link svg {
        width: 20px;
        height: 20px;
      }

      .footer-bottom {
        padding-top: 1rem;
        margin-top: 1rem;
        font-size: 0.8rem;
      }
    }

    /* Small Mobile (375px) */
    @media (max-width: 400px) {
      .footer {
        padding: 1.5rem 0.5rem 0.5rem;
      }

      .footer-section {
        padding: 0.8rem;
        border-radius: 8px;
      }

      .footer-logo img {
        width: 60px;
        height: 60px;
      }

      .footer-logo h2 {
        font-size: 1.3rem;
      }

      .footer-tagline {
        font-size: 0.8rem;
      }

      .bismillah {
        font-size: 1rem;
      }

      .footer-section-title {
        font-size: 1rem;
        margin-bottom: 0.8rem;
        padding-bottom: 0.5rem;
      }

      .footer-links a {
        padding: 0.3rem 0.6rem 0.3rem 1.2rem;
        font-size: 0.85rem;
      }

      .social-link {
        width: 38px;
        height: 38px;
      }

      .social-link svg {
        width: 18px;
        height: 18px;
      }

      .email-box {
        padding: 0.8rem;
      }

      .email-box a {
        font-size: 0.8rem;
      }

      .footer-bottom {
        padding-top: 0.8rem;
        margin-top: 0.8rem;
        font-size: 0.75rem;
      }

      .footer-bottom p {
        margin: 0.4rem 0;
      }
    }
  </style>
</head>
<body>
  <nav class="navbar">
    <h1>MuslimBro1400</h1>
    <button class="menu-toggle" onclick="toggleMenu()"><img src="menu.png" alt="Menu"></button>
    <div class="nav-links">
      <a href="index.html">Home</a> 
      <a href="quran.html">Quran</a> 
      <a href="hadith.html">Hadiths</a>
      <a href="islamic-books.html">Books</a> 
      <a href="quran-recitations.html">Recitations</a>
      <a href="islamic-calendar.html">Calendar</a> 
      <a href="about.html">About</a>
      <button class="theme-toggle" onclick="toggleTheme()"><img id="theme-icon" src="moon.png" alt="Toggle Theme"></button>
    </div>
  </nav>
  <div class="banner"><img class="banner-img" src="banner.png" alt="Banner"></div>
  
  <div class="container">
    <h1><hr> Sahih al-Bukhari (<span class="arabic">صحيح البخاري</span>)<hr></h1>

    <p class="description">Sahih al-Bukhari, compiled by Imam Muhammad al-Bukhari (<span class="arabic">رحمه الله</span>, d. 256 AH/870 CE), is widely regarded as the most authentic collection of hadith in Islamic scholarship. This esteemed work documents the <span class="arabic">Sunnah</span> of the Prophet Muhammad (<span class="arabic">ﷺ</span>), encompassing over 7,500 narrations across 97 books, serving as a cornerstone for Islamic guidance and practice.<hr></p><br>

    <div class="tabs">
      <button class="tab-button active" onclick="showAll()">All Hadiths</button>
      <button class="tab-button" onclick="showMy()">My Hadiths</button>
    </div>

    <div id="chaptersGrid" class="cards-vertical-grid"></div>
  </div>

  <!-- ========== HADITH MODAL (CAROUSEL) ========== -->
  <div id="hadith-modal" class="modal">
    <div class="modal-content">
      <span style="position:absolute; top:20px; right:25px; font-size:30px; cursor:pointer;" onclick="closeHadithModal()">&times;</span>
      <div class="hadith-info">
        <h1 id="modal-chapter-title"></h1>
        <p id="modal-chapter-subtitle" class="subtitle"></p>
        <p id="modal-chapter-meta" class="meta"></p>
      </div>
      <div class="tabs" style="margin-top:0;">
        <button class="tab-button active" onclick="switchModalTab('carousel')">Carousel</button>
      </div>
      <div id="modal-carousel-tab"></div>
    </div>
  </div>

  <!-- ========== SHARE MODAL (fully styled) ========== -->
  <div id="share-modal" class="modal">
    <div class="modal-content">
      <h2>Share Hadith</h2>
      <div><label><input type="checkbox" id="include-arabic" checked> Include Arabic text</label></div>
      <div><label><input type="checkbox" id="include-translation" checked> Include translation</label></div>
      <div>
        <label for="share-language">Translation language:</label>
        <select id="share-language">
          <option value="en">English</option>
          <option value="ur">Urdu</option>
        </select>
      </div>
      <button onclick="shareHadith()">Copy to Clipboard</button>
      <button onclick="closeShareModal()">Cancel</button>
      <div id="copy-message" style="display:none;">✓ Copied to clipboard!</div>
    </div>
  </div>

  <button id="scrollToTop" onclick="scrollToTop()">↑</button>

  <footer class="footer">
    <div class="footer-pattern"></div>
    <div class="footer-content">
      <div class="footer-section footer-logo-section">
        <div class="bismillah">بِسْمِ اللَّهِ الرَّحْمَنِ الرَّحِيم</div>
        <div class="footer-logo">
          <img src="favicon.png" alt="MuslimBro1400 Logo" />
        </div>
        <h2>MuslimBro1400</h2>
        <p class="footer-tagline">Your Trusted Islamic Resource</p>
        <div class="social-links">
          <a href="#" class="social-link facebook" title="Facebook">
            <!-- Updated Facebook SVG -->
            <svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 224.74 224.74">
              <defs>
                <style>.cls-1{fill:#395398;}.cls-2{fill:#fff;}</style>
              </defs>
              <path class="cls-1" d="M224.74,112.37c0,1,0,1.94,0,2.9s0,1.82-.1,2.73c0,.12,0,.24,0,.36,0,.7-.08,1.4-.13,2.1s-.1,1.38-.17,2.07c-.1,1.17-.23,2.35-.37,3.51q-.42,3.37-1,6.69a112.33,112.33,0,0,1-20,46.27c-.43.59-.87,1.17-1.32,1.75s-.89,1.16-1.35,1.73c-1.61,2-3.29,4-5,5.89-.38.42-.77.84-1.17,1.25-.75.8-1.51,1.58-2.29,2.36q-1.83,1.83-3.75,3.57c-.67.6-1.34,1.2-2,1.79s-1.35,1.15-2,1.71l-.07.06c-.68.56-1.37,1.12-2.06,1.66s-1.43,1.11-2.15,1.65l-2.09,1.52-.34.24-1.62,1.13c-.63.43-1.26.85-1.89,1.25l-1.07.7c-2,1.25-4,2.44-6,3.56-.64.36-1.3.71-1.95,1.05l-2,1-2,1c-1.36.65-2.74,1.28-4.13,1.86l-2.06.85a.09.09,0,0,1-.07,0l-2,.78a.44.44,0,0,1-.16.06l-2.09.77c-1.44.51-2.89,1-4.36,1.45V146.3h27l4-31.34h-31V95c0-9.08,2.52-15.26,15.52-15.26h16.6v-28a221.85,221.85,0,0,0-24.18-1.23c-23.92,0-40.3,14.6-40.3,41.41V115h-27v31.38h27v78.37h-1A112.37,112.37,0,1,1,224.74,112.37Z" transform="translate(0 0)"/>
              <path class="cls-2" d="M145.73,95v20h31l-4,31.34h-27v73.39c1.47-.46,2.92-.94,4.36-1.45a111.67,111.67,0,0,1-36.72,6.49V146.37h-27V115h27V91.88c0-26.81,16.38-41.41,40.3-41.41a221.85,221.85,0,0,1,24.18,1.23v28h-16.6C148.25,79.7,145.73,85.88,145.73,95Z" transform="translate(0 0)"/>
            </svg>
          </a>
          <a href="#" class="social-link twitter" title="Twitter">
            <!-- Twitter SVG -->
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 224.74 224.74">
              <path fill="#111" d="M224.74,112.37A112.37,112.37,0,1,1,112.37,0,112.37,112.37,0,0,1,224.74,112.37Z" transform="translate(0 0.01)"/>
              <polygon fill="#fff" points="184.14 59.9 184.14 59.9 184.14 59.9 184.14 59.9"/>
              <path fill="#fff" d="M184.14,59.88Z" transform="translate(0 0.01)"/>
              <path fill="#fff" d="M163.86,161.37l-40.29-58.56L119,96.19,90.19,54.31,87.8,50.84H52.37L61,63.37l38.36,55.71,4.56,6.61,30.79,44.75,2.39,3.46h35.42Zm-22.57,4.54-32-46.48-4.56-6.62L67.61,58.87h16l30,43.62,4.56,6.62,39.09,56.8Z" transform="translate(0 0.01)"/>
              <polygon fill="#fff" points="104.75 112.8 109.3 119.42 103.9 125.71 62.46 173.92 52.24 173.92 99.35 119.09 104.75 112.8"/>
              <polygon fill="#fff" points="168.24 50.85 123.57 102.82 118.17 109.1 113.61 102.49 119.02 96.2 149.28 60.98 158.03 50.85 168.24 50.85"/>
            </svg>
          </a>
          <a href="#" class="social-link instagram" title="Instagram">
            <!-- Instagram SVG -->
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 224.74 224.74">
              <defs>
                <radialGradient id="instagram-gradient" cx="81.51" cy="-395.56" fx="-51.82007726007717" r="317.66" gradientTransform="matrix(0.65, -0.76, -0.61, -0.53, -185.81, -27)" gradientUnits="userSpaceOnUse">
                  <stop offset="0" stop-color="#f9ed32"/>
                  <stop offset="0.05" stop-color="#f8d939"/>
                  <stop offset="0.17" stop-color="#f5a54d"/>
                  <stop offset="0.33" stop-color="#f0536c"/>
                  <stop offset="0.4" stop-color="#ee2a7b"/>
                  <stop offset="0.56" stop-color="#9e2aa7"/>
                  <stop offset="0.72" stop-color="#5b2acd"/>
                  <stop offset="0.85" stop-color="#2a2ae8"/>
                  <stop offset="0.95" stop-color="#0b2af9"/>
                  <stop offset="1" stop-color="#002aff"/>
                </radialGradient>
              </defs>
              <path fill="url(#instagram-gradient)" d="M224.74,112.37A112.37,112.37,0,1,1,112.37,0h0A112.37,112.37,0,0,1,224.74,112.37Z" transform="translate(0)"/>
              <path fill="#fff" d="M142.82,188.21H81.93a49.05,49.05,0,0,1-49-49V85.54a49.05,49.05,0,0,1,49-49h60.89a49.05,49.05,0,0,1,49,49V139.2A49.06,49.06,0,0,1,142.82,188.21ZM81.93,47.42A38.16,38.16,0,0,0,43.81,85.54V139.2a38.16,38.16,0,0,0,38.12,38.17h60.89a38.16,38.16,0,0,0,38.11-38.12V85.54a38.16,38.16,0,0,0-38.11-38.12Z" transform="translate(0)"/>
              <path fill="#fff" d="M112.37,156A43.63,43.63,0,1,1,156,112.37,43.63,43.63,0,0,1,112.37,156Zm0-76.37a32.74,32.74,0,1,0,32.74,32.74h0A32.78,32.78,0,0,0,112.37,79.63Z" transform="translate(0)"/>
              <path fill="#fff" d="M164.37,70.09A9.05,9.05,0,1,1,155.32,61a9,9,0,0,1,9.05,9.06Z" transform="translate(0)"/>
            </svg>
          </a>
          <a href="#" class="social-link youtube" title="YouTube">
            <!-- YouTube SVG -->
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 224.74 224.74">
              <path fill="#e52929" d="M224.74,112.37A112.37,112.37,0,1,1,112.37,0,112.37,112.37,0,0,1,224.74,112.37Z" transform="translate(0 0.01)"/>
              <path fill="#fff" d="M181.69,93.87A30.17,30.17,0,0,0,151.52,63.7H73.22A30.17,30.17,0,0,0,43.05,93.87h0v37A30.17,30.17,0,0,0,73.22,161h78.3a30.17,30.17,0,0,0,30.17-30.17h0Zm-50.32,19.57L100.2,130.56c-1.36.73-2.56-.25-2.56-1.79V93.64c0-1.56,1.24-2.54,2.59-1.77l31.41,18a2,2,0,0,1,.69,2.74A1.94,1.94,0,0,1,131.37,113.44Z" transform="translate(0 0.01)"/>
            </svg>
          </a>
        </div>
      </div>
      
      <div class="footer-section footer-links-section">
        <h3 class="footer-section-title">Quick Links</h3>
        <ul class="footer-links">
          <li><a href="index.html">Home</a></li>
          <li><a href="quran.html">Quran with Translations</a></li>
          <li><a href="hadith.html">Hadiths and Sunnah</a></li>
          <li><a href="islamic-books.html">Islamic Books</a></li>
          <li><a href="quran-recitations.html">Quran Recitations</a></li>
          <li><a href="islamic-calendar.html">Islamic Calendar</a></li>
          <li><a href="about.html">About Us</a></li>
        </ul>
      </div>
      
      <div class="footer-section footer-contact">
        <h3 class="footer-section-title">Contact Us</h3>
        <div class="contact-info">
          <div class="email-box">
            <a href="mailto:muhammadadil43534@gmail.com" target="_blank">muhammadadil43534@gmail.com</a>
          </div>
        </div>
        <div class="social-links" style="margin-top: 1rem;">
          <a href="#" class="social-link facebook" title="Facebook">
            <!-- Updated Facebook SVG -->
            <svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 224.74 224.74">
              <defs>
                <style>.cls-1{fill:#395398;}.cls-2{fill:#fff;}</style>
              </defs>
              <path class="cls-1" d="M224.74,112.37c0,1,0,1.94,0,2.9s0,1.82-.1,2.73c0,.12,0,.24,0,.36,0,.7-.08,1.4-.13,2.1s-.1,1.38-.17,2.07c-.1,1.17-.23,2.35-.37,3.51q-.42,3.37-1,6.69a112.33,112.33,0,0,1-20,46.27c-.43.59-.87,1.17-1.32,1.75s-.89,1.16-1.35,1.73c-1.61,2-3.29,4-5,5.89-.38.42-.77.84-1.17,1.25-.75.8-1.51,1.58-2.29,2.36q-1.83,1.83-3.75,3.57c-.67.6-1.34,1.2-2,1.79s-1.35,1.15-2,1.71l-.07.06c-.68.56-1.37,1.12-2.06,1.66s-1.43,1.11-2.15,1.65l-2.09,1.52-.34.24-1.62,1.13c-.63.43-1.26.85-1.89,1.25l-1.07.7c-2,1.25-4,2.44-6,3.56-.64.36-1.3.71-1.95,1.05l-2,1-2,1c-1.36.65-2.74,1.28-4.13,1.86l-2.06.85a.09.09,0,0,1-.07,0l-2,.78a.44.44,0,0,1-.16.06l-2.09.77c-1.44.51-2.89,1-4.36,1.45V146.3h27l4-31.34h-31V95c0-9.08,2.52-15.26,15.52-15.26h16.6v-28a221.85,221.85,0,0,0-24.18-1.23c-23.92,0-40.3,14.6-40.3,41.41V115h-27v31.38h27v78.37h-1A112.37,112.37,0,1,1,224.74,112.37Z" transform="translate(0 0)"/>
              <path class="cls-2" d="M145.73,95v20h31l-4,31.34h-27v73.39c1.47-.46,2.92-.94,4.36-1.45a111.67,111.67,0,0,1-36.72,6.49V146.37h-27V115h27V91.88c0-26.81,16.38-41.41,40.3-41.41a221.85,221.85,0,0,1,24.18,1.23v28h-16.6C148.25,79.7,145.73,85.88,145.73,95Z" transform="translate(0 0)"/>
            </svg>
          </a>
          <a href="#" class="social-link twitter" title="Twitter">
            <!-- Twitter SVG -->
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 224.74 224.74">
              <path fill="#111" d="M224.74,112.37A112.37,112.37,0,1,1,112.37,0,112.37,112.37,0,0,1,224.74,112.37Z" transform="translate(0 0.01)"/>
              <polygon fill="#fff" points="184.14 59.9 184.14 59.9 184.14 59.9 184.14 59.9"/>
              <path fill="#fff" d="M184.14,59.88Z" transform="translate(0 0.01)"/>
              <path fill="#fff" d="M163.86,161.37l-40.29-58.56L119,96.19,90.19,54.31,87.8,50.84H52.37L61,63.37l38.36,55.71,4.56,6.61,30.79,44.75,2.39,3.46h35.42Zm-22.57,4.54-32-46.48-4.56-6.62L67.61,58.87h16l30,43.62,4.56,6.62,39.09,56.8Z" transform="translate(0 0.01)"/>
              <polygon fill="#fff" points="104.75 112.8 109.3 119.42 103.9 125.71 62.46 173.92 52.24 173.92 99.35 119.09 104.75 112.8"/>
              <polygon fill="#fff" points="168.24 50.85 123.57 102.82 118.17 109.1 113.61 102.49 119.02 96.2 149.28 60.98 158.03 50.85 168.24 50.85"/>
            </svg>
          </a>
          <a href="#" class="social-link instagram" title="Instagram">
            <!-- Instagram SVG -->
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 224.74 224.74">
              <defs>
                <radialGradient id="instagram-gradient2" cx="81.51" cy="-395.56" fx="-51.82007726007717" r="317.66" gradientTransform="matrix(0.65, -0.76, -0.61, -0.53, -185.81, -27)" gradientUnits="userSpaceOnUse">
                  <stop offset="0" stop-color="#f9ed32"/>
                  <stop offset="0.05" stop-color="#f8d939"/>
                  <stop offset="0.17" stop-color="#f5a54d"/>
                  <stop offset="0.33" stop-color="#f0536c"/>
                  <stop offset="0.4" stop-color="#ee2a7b"/>
                  <stop offset="0.56" stop-color="#9e2aa7"/>
                  <stop offset="0.72" stop-color="#5b2acd"/>
                  <stop offset="0.85" stop-color="#2a2ae8"/>
                  <stop offset="0.95" stop-color="#0b2af9"/>
                  <stop offset="1" stop-color="#002aff"/>
                </radialGradient>
              </defs>
              <path fill="url(#instagram-gradient2)" d="M224.74,112.37A112.37,112.37,0,1,1,112.37,0h0A112.37,112.37,0,0,1,224.74,112.37Z" transform="translate(0)"/>
              <path fill="#fff" d="M142.82,188.21H81.93a49.05,49.05,0,0,1-49-49V85.54a49.05,49.05,0,0,1,49-49h60.89a49.05,49.05,0,0,1,49,49V139.2A49.06,49.06,0,0,1,142.82,188.21ZM81.93,47.42A38.16,38.16,0,0,0,43.81,85.54V139.2a38.16,38.16,0,0,0,38.12,38.17h60.89a38.16,38.16,0,0,0,38.11-38.12V85.54a38.16,38.16,0,0,0-38.11-38.12Z" transform="translate(0)"/>
              <path fill="#fff" d="M112.37,156A43.63,43.63,0,1,1,156,112.37,43.63,43.63,0,0,1,112.37,156Zm0-76.37a32.74,32.74,0,1,0,32.74,32.74h0A32.78,32.78,0,0,0,112.37,79.63Z" transform="translate(0)"/>
              <path fill="#fff" d="M164.37,70.09A9.05,9.05,0,1,1,155.32,61a9,9,0,0,1,9.05,9.06Z" transform="translate(0)"/>
            </svg>
          </a>
          <a href="#" class="social-link youtube" title="YouTube">
            <!-- YouTube SVG -->
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 224.74 224.74">
              <path fill="#e52929" d="M224.74,112.37A112.37,112.37,0,1,1,112.37,0,112.37,112.37,0,0,1,224.74,112.37Z" transform="translate(0 0.01)"/>
              <path fill="#fff" d="M181.69,93.87A30.17,30.17,0,0,0,151.52,63.7H73.22A30.17,30.17,0,0,0,43.05,93.87h0v37A30.17,30.17,0,0,0,73.22,161h78.3a30.17,30.17,0,0,0,30.17-30.17h0Zm-50.32,19.57L100.2,130.56c-1.36.73-2.56-.25-2.56-1.79V93.64c0-1.56,1.24-2.54,2.59-1.77l31.41,18a2,2,0,0,1,.69,2.74A1.94,1.94,0,0,1,131.37,113.44Z" transform="translate(0 0.01)"/>
            </svg>
          </a>
        </div>
      </div>
    </div>
    
    <div class="footer-bottom">
      <p>&copy; 2024 <a href="index.html">MuslimBro1400</a>. All rights reserved.</p>
      <p>Made with ❤️ for the Ummah</p>
    </div>
  </footer>

<script>
// Global variables
let hadiths = []; // Will hold current chapter's hadiths
let allHadiths = {}; // Cache for loaded chapters
let isLoadingInitialData = false; // Flag to prevent multiple loads

const chapters = [
  { id: 1, title: "Revelation", artitle: "<span class=\"arabic\">(كتاب بدء الوحى)</span>", subtitle: "Start of Divine Revelation", hadithCount: 7, file: "bukhari-chp1.json" },
  { id: 2, title: "Belief", artitle: "<span class=\"arabic\">(كتاب الإيمان)</span>", subtitle: "Faith And Its Branches", hadithCount: 51, file: "bukhari-chp2.json" },
  { id: 3, title: "Knowledge", artitle: "<span class=\"arabic\">(كتاب العلم)</span>", subtitle: "Importance Of Seeking Knowledge", hadithCount: 76, file: "bukhari-chp3.json" },
  { id: 4, title: "Abulutions (Wudu')", artitle: "<span class=\"arabic\">(كتاب الوضوء)</span>", subtitle: "How To Make Wudu'", hadithCount: 113, file: "bukhari-chp4.json" },
  { id: 5, title: "Bathing (Ghusl)", artitle: "<span class=\"arabic\">(كتاب الغسل)</span>", subtitle: "Performing Ghusl", hadithCount: 46, file: "bukhari-chp5.json" }
  // Add more chapters as you create their JSON files
];

// ---------- STORAGE ----------
let favoritedHadiths = JSON.parse(localStorage.getItem('favoritedHadiths') || '[]');
let bookmarkedHadiths = JSON.parse(localStorage.getItem('bookmarkedHadiths') || '[]');
let favoritedChapters = JSON.parse(localStorage.getItem('favoritedChapters') || '[]');
let bookmarkedChapters = JSON.parse(localStorage.getItem('bookmarkedChapters') || '[]');

// Fix legacy - ensure all entries have the correct format
function normalizeSavedItems(items) {
  return items.map(item => {
    if (typeof item === 'number') {
      return { chp: 1, id: item };
    }
    // Ensure both chp and id are numbers
    return {
      chp: parseInt(item.chp) || 1,
      id: parseInt(item.id) || item.id
    };
  });
}

favoritedHadiths = normalizeSavedItems(favoritedHadiths);
bookmarkedHadiths = normalizeSavedItems(bookmarkedHadiths);

// ---------- SVG ICONS ----------
const favSvg = (filled=false)=> filled 
  ? `<svg width="24" height="24" viewBox="0 0 24 24" fill="#0c8" stroke="#0c8" stroke-width="2"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/></svg>`
  : `<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#0c8" stroke-width="2"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/></svg>`;
const bkmSvg = (filled=false)=> filled
  ? `<svg width="24" height="24" viewBox="0 0 800 800" fill="#00CC88"><path d="M166.7,206.7c0-37.3,0-56,7.3-70.3c6.4-12.5,16.6-22.7,29.1-29.1c14.3-7.3,32.9-7.3,70.3-7.3h253.3c37.3,0,56,0,70.3,7.3c12.5,6.4,22.7,16.6,29.1,29.1c7.3,14.3,7.3,32.9,7.3,70.3V700L400,533.3L166.7,700V206.7z"/></svg>`
  : `<svg width="24" height="24" viewBox="0 0 800 800" fill="none" stroke="#00CC88" stroke-width="66.66"><path d="M166.7,206.7c0-37.3,0-56,7.3-70.3c6.4-12.5,16.6-22.7,29.1-29.1c14.3-7.3,32.9-7.3,70.3-7.3h253.3c37.3,0,56,0,70.3,7.3c12.5,6.4,22.7,16.6,29.1,29.1c7.3,14.3,7.3,32.9,7.3,70.3V700L400,533.3L166.7,700V206.7z"/></svg>`;

// ---------- LOAD ALL NEEDED CHAPTERS FOR SAVED HADITHS ----------
async function loadAllSavedChapters() {
  const allChapterIds = new Set();
  
  // Collect all unique chapter IDs from saved hadiths
  [...favoritedHadiths, ...bookmarkedHadiths].forEach(item => {
    if (item && item.chp) {
      allChapterIds.add(parseInt(item.chp));
    }
  });
  
  console.log('Loading chapters:', Array.from(allChapterIds)); // Debug log
  
  // Load each chapter's hadiths
  const loadPromises = [];
  for (const chpId of allChapterIds) {
    const chapter = chapters.find(c => c.id === chpId);
    if (chapter && !allHadiths[chpId]) {
      loadPromises.push(loadChapterHadiths(chapter));
    }
  }
  
  if (loadPromises.length > 0) {
    await Promise.all(loadPromises);
  }
  
  console.log('Loaded allHadiths:', allHadiths); // Debug log
}

// ---------- LOAD CHAPTER HADITHS ----------
async function loadChapterHadiths(chapter) {
  // Check if already cached
  if (allHadiths[chapter.id]) {
    return allHadiths[chapter.id];
  }
  
  try {
    // Load from the "bukhari hadiths" folder
    const response = await fetch(`bukhari hadiths/${chapter.file}`);
    if (!response.ok) {
      throw new Error(`Failed to load ${chapter.file}`);
    }
    const data = await response.json();
    // Cache the loaded hadiths
    allHadiths[chapter.id] = data;
    console.log(`Loaded chapter ${chapter.id} with ${data.length} hadiths`); // Debug log
    return data;
  } catch (error) {
    console.error(`Error loading chapter ${chapter.id}:`, error);
    // Return empty array on error instead of throwing
    return [];
  }
}

// ---------- CHECK IF HADITH IS SAVED ----------
function isHadithSaved(savedList, chp, id) {
  return savedList.some(item => 
    parseInt(item.chp) === parseInt(chp) && 
    parseInt(item.id) === parseInt(id)
  );
}

// ---------- AUTO-CLOSE MESSAGE FUNCTION (ONLY FOR NO HADITHS) ----------
function showNoHadithsMessage(message) {
  const messageDiv = document.createElement('div');
  messageDiv.className = 'no-hadiths-message';
  messageDiv.textContent = message;
  messageDiv.style.cssText = `
    position: fixed;
    top: 20px;
    left: 50%;
    transform: translateX(-50%);
    background: #ff6b6b;
    color: white;
    padding: 12px 24px;
    border-radius: 8px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    z-index: 10000;
    font-size: 1rem;
    animation: slideDown 0.3s ease;
    cursor: pointer;
  `;
  
  // Add close button
  const closeBtn = document.createElement('span');
  closeBtn.innerHTML = '&times;';
  closeBtn.style.cssText = `
    margin-left: 12px;
    font-size: 1.2rem;
    font-weight: bold;
    cursor: pointer;
    opacity: 0.8;
  `;
  closeBtn.onclick = () => messageDiv.remove();
  messageDiv.appendChild(closeBtn);
  
  document.body.appendChild(messageDiv);
  
  // Auto close after 3 seconds
  setTimeout(() => {
    if (messageDiv.parentNode) {
      messageDiv.style.animation = 'fadeOut 0.3s ease';
      setTimeout(() => messageDiv.remove(), 300);
    }
  }, 3000);
  
  // Add animation styles if not already present
  if (!document.getElementById('message-animations')) {
    const style = document.createElement('style');
    style.id = 'message-animations';
    style.textContent = `
      @keyframes slideDown {
        from {
          top: -100px;
          opacity: 0;
        }
        to {
          top: 20px;
          opacity: 1;
        }
      }
      @keyframes fadeOut {
        from {
          opacity: 1;
        }
        to {
          opacity: 0;
        }
      }
    `;
    document.head.appendChild(style);
  }
  
  return messageDiv;
}

// ---------- RENDER ALL CHAPTERS (FIXED GRID) ----------
const grid = document.getElementById('chaptersGrid');
function renderAllChapters() {
  grid.innerHTML = '';
  chapters.forEach(ch => {
    const card = document.createElement('div');
    card.className = 'card';
    card.setAttribute('data-chapter', ch.id);
    card.onclick = (e) => { if (!e.target.closest('.icons')) openHadithModal(ch); };
    const isFav = favoritedChapters.includes(ch.id);
    const isBkm = bookmarkedChapters.includes(ch.id);
    card.innerHTML = `
      <img src="bukhari images/book${ch.id}.jpg" alt="${ch.title}" onerror="this.src='pic1.jpg'">
      <div class="icons">
        <span class="favorite-icon" onclick="event.stopPropagation(); toggleFavoriteChapter(${ch.id});">${favSvg(isFav)}</span>
        <span class="bookmark-icon" onclick="event.stopPropagation(); toggleBookmarkChapter(${ch.id});">${bkmSvg(isBkm)}</span>
      </div>
      <div class="overlay">
        <span class="surah-number">Book ${ch.id}: ${ch.title}</span>
        <div class="additional-details">
          <span>Hadiths: ${ch.hadithCount}</span>
        </div>
        <div class="quick-actions">
          <button onclick="event.stopPropagation(); openHadithModal(${JSON.stringify(ch).replace(/"/g,'&quot;')});">Read</button>
        </div>
      </div>
    `;
    grid.appendChild(card);
  });
}

// ---------- CHAPTER FAV/BOOKMARK ----------
window.toggleFavoriteChapter = (id) => {
  let f = JSON.parse(localStorage.getItem('favoritedChapters')||'[]');
  f.includes(id) ? f = f.filter(i=>i!==id) : f.push(id);
  localStorage.setItem('favoritedChapters',JSON.stringify(f));
  favoritedChapters = f;
  renderAllChapters();
  
  // If in My Hadiths tab, refresh it
  const activeTab = document.querySelector('.tab-button.active');
  if (activeTab && activeTab.getAttribute('onclick')?.includes('showMy')) {
    showMy();
  }
};

window.toggleBookmarkChapter = (id) => {
  let b = JSON.parse(localStorage.getItem('bookmarkedChapters')||'[]');
  b.includes(id) ? b = b.filter(i=>i!==id) : b.push(id);
  localStorage.setItem('bookmarkedChapters',JSON.stringify(b));
  bookmarkedChapters = b;
  renderAllChapters();
  
  // If in My Hadiths tab, refresh it
  const activeTab = document.querySelector('.tab-button.active');
  if (activeTab && activeTab.getAttribute('onclick')?.includes('showMy')) {
    showMy();
  }
};

// ---------- MODAL CAROUSEL ----------
let currentChapterHadiths = [];
let currentCarouselIndex = 0;
let currentChapter = null;

// Store original modal content
const modal = document.getElementById('hadith-modal');
const modalContent = modal.querySelector('.modal-content');
const originalModalHTML = modalContent.innerHTML;

function resetModalToOriginal() {
  modalContent.innerHTML = originalModalHTML;
}

window.openHadithModal = async (chapter, hadithId = null) => {
  currentChapter = chapter;
  
  // Reset modal to original state first
  resetModalToOriginal();
  
  // Show loading state
  modalContent.innerHTML = '<div class="loading-spinner">Loading hadiths...</div>';
  modal.classList.add('show');
  
  // Load chapter-specific hadiths
  const chapterHadiths = await loadChapterHadiths(chapter);
  currentChapterHadiths = chapterHadiths;
  
  if (!currentChapterHadiths.length) {
    // Show auto-close message and close modal
    showNoHadithsMessage('No hadiths available for this chapter yet.');
    modal.classList.remove('show');
    resetModalToOriginal();
    return;
  }
  
  currentCarouselIndex = 0;
  if (hadithId !== null) {
    const idx = currentChapterHadiths.findIndex(h => parseInt(h.id) === parseInt(hadithId));
    if (idx > -1) currentCarouselIndex = idx;
  }
  
  // Restore original modal content and populate it
  resetModalToOriginal();
  document.getElementById('modal-chapter-title').innerHTML = `Book ${chapter.id}: ${chapter.title} ${chapter.artitle}`;
  document.getElementById('modal-chapter-subtitle').innerText = chapter.subtitle || '';
  document.getElementById('modal-chapter-meta').innerText = `Hadiths: ${currentChapterHadiths.length}`;
  renderCarouselTab();
};

window.closeHadithModal = () => {
  modal.classList.remove('show');
  resetModalToOriginal();
  // Clear current hadiths to free memory
  currentChapterHadiths = [];
};
window.switchModalTab = () => {};

function renderCarouselTab() {
  const tab = document.getElementById('modal-carousel-tab');
  if (!tab) return;
  
  tab.innerHTML = '';
  if (!currentChapterHadiths.length) return;
  
  // language select
  const langDiv = document.createElement('div');
  langDiv.className = 'carousel-lang-select';
  langDiv.innerHTML = `<label>Translation:</label>
    <select id="carousel-lang" onchange="renderCarouselHadith()">
      <option value="en">English</option>
      <option value="ur">اردو</option>
    </select>`;
  tab.appendChild(langDiv);
  
  // Go to Hadith
  const goToDiv = document.createElement('div');
  goToDiv.className = 'go-to-hadith';
  goToDiv.innerHTML = `<input type="number" id="go-to-hadith-input" placeholder="Go" min="1" max="${currentChapterHadiths.length}" onkeypress="if(event.key==='Enter')goToHadith()">
    <button onclick="goToHadith()">Go</button>`;
  tab.appendChild(goToDiv);
  
  const carouselDiv = document.createElement('div');
  carouselDiv.id = 'carousel-container';
  carouselDiv.className = 'carousel-container';
  tab.appendChild(carouselDiv);
  
  const nav = document.createElement('div');
  nav.className = 'nav-buttons';
  nav.innerHTML = `<button onclick="prevHadith()" id="prevBtn" class="nav-btn">
      <svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
        <path d="M15 18l-6-6 6-6"/>
      </svg>
      <span>Previous</span>
    </button>
    <span id="carouselCounter" class="carousel-counter">1 / ${currentChapterHadiths.length}</span>
    <button onclick="nextHadith()" id="nextBtn" class="nav-btn">
      <span>Next</span>
      <svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
        <path d="M9 18l6-6-6-6"/>
      </svg>
    </button>`;
  tab.appendChild(nav);
  renderCarouselHadith();
}

window.goToHadith = function() {
  const input = document.getElementById('go-to-hadith-input');
  if (!input || !currentChapterHadiths.length) return;
  const hadithNum = parseInt(input.value);
  if (isNaN(hadithNum) || hadithNum < 1 || hadithNum > currentChapterHadiths.length) {
    // Just highlight the input, no message
    input.style.border = '2px solid #ff6b6b';
    setTimeout(() => input.style.border = '', 2000);
    return;
  }
  input.style.border = '';
  currentCarouselIndex = hadithNum - 1;
  renderCarouselHadith();
  input.value = '';
};

window.renderCarouselHadith = function() {
  const carouselDiv = document.getElementById('carousel-container');
  if (!carouselDiv) return;
  
  // Safety check
  if (!currentChapterHadiths || !currentChapterHadiths.length) {
    carouselDiv.innerHTML = '<div class="error-placeholder"></div>';
    return;
  }
  
  const hadith = currentChapterHadiths[currentCarouselIndex];
  if (!hadith) {
    carouselDiv.innerHTML = '<div class="error-placeholder"></div>';
    return;
  }
  
  const lang = document.getElementById('carousel-lang')?.value || 'en';
  const isFav = isHadithSaved(favoritedHadiths, hadith.chp, hadith.id);
  const isBkm = isHadithSaved(bookmarkedHadiths, hadith.chp, hadith.id);
  
  // Use hadith.book directly since it's a string in your JSON
  const bookName = hadith.book || "Sahih al-Bukhari";
  
  carouselDiv.innerHTML = `
    <div class="carousel-hadith">
      <span class="hadith-number">Hadith ${hadith.id} | Chapter: ${hadith.chp_title}</span>
      <div class="arabic">${hadith.arabic}</div>
      <div class="translation ${lang==='ur'?'ur':''}">${hadith[lang]}</div>
      <div class="hadith-meta">${bookName} • Vol ${hadith.volume}</div>
      <div class="hadith-actions">
        <button class="action-button ${isFav?'favorited':''}" onclick="toggleFavoriteHadith(${hadith.chp}, ${hadith.id}, event)">${favSvg(isFav)}</button>
        <button class="action-button ${isBkm?'bookmarked':''}" onclick="toggleBookmarkHadith(${hadith.chp}, ${hadith.id}, event)">${bkmSvg(isBkm)}</button>
        <button class="action-button" onclick="openShareModal(${hadith.chp}, ${hadith.id}, event)"><svg width="28" height="28" viewBox="0 0 24 24" stroke="currentColor" fill="none" stroke-width="2"><circle cx="18" cy="5" r="3"/><circle cx="6" cy="12" r="3"/><circle cx="18" cy="19" r="3"/><path d="m8.59 13.51 6.83 3.98"/><path d="m15.41 6.51-6.82 3.98"/></svg></button>
      </div>
    </div>
  `;
  document.getElementById('carouselCounter').innerText = `${currentCarouselIndex+1} / ${currentChapterHadiths.length}`;
  document.getElementById('prevBtn').disabled = currentCarouselIndex === 0;
  document.getElementById('nextBtn').disabled = currentCarouselIndex === currentChapterHadiths.length-1;
};

window.nextHadith = function() { 
  if (currentChapterHadiths && currentCarouselIndex < currentChapterHadiths.length-1) { 
    currentCarouselIndex++; 
    renderCarouselHadith(); 
  } 
};

window.prevHadith = function() { 
  if (currentChapterHadiths && currentCarouselIndex > 0) { 
    currentCarouselIndex--; 
    renderCarouselHadith(); 
  } 
};

// ---------- FAV/BOOKMARK HADITH ----------
window.toggleFavoriteHadith = (chp, id, ev) => {
  ev?.stopPropagation();
  
  // Ensure IDs are numbers
  chp = parseInt(chp);
  id = parseInt(id);
  
  let favs = JSON.parse(localStorage.getItem('favoritedHadiths')||'[]');
  const idx = favs.findIndex(f => parseInt(f.chp) === chp && parseInt(f.id) === id);
  
  if (idx > -1) {
    favs.splice(idx, 1);
  } else {
    favs.push({chp, id});
  }
  
  localStorage.setItem('favoritedHadiths', JSON.stringify(favs));
  favoritedHadiths = favs;
  
  // If we're in the carousel, update it
  if (currentChapterHadiths.length) {
    renderCarouselHadith();
  }
  
  // If we're in My Hadiths tab, refresh the display
  const activeTab = document.querySelector('.tab-button.active');
  if (activeTab && activeTab.getAttribute('onclick')?.includes('showMy')) {
    showMy();
  }
};

window.toggleBookmarkHadith = (chp, id, ev) => {
  ev?.stopPropagation();
  
  // Ensure IDs are numbers
  chp = parseInt(chp);
  id = parseInt(id);
  
  let bks = JSON.parse(localStorage.getItem('bookmarkedHadiths')||'[]');
  const idx = bks.findIndex(f => parseInt(f.chp) === chp && parseInt(f.id) === id);
  
  if (idx > -1) {
    bks.splice(idx, 1);
  } else {
    bks.push({chp, id});
  }
  
  localStorage.setItem('bookmarkedHadiths', JSON.stringify(bks));
  bookmarkedHadiths = bks;
  
  // If we're in the carousel, update it
  if (currentChapterHadiths.length) {
    renderCarouselHadith();
  }
  
  // If we're in My Hadiths tab, refresh the display
  const activeTab = document.querySelector('.tab-button.active');
  if (activeTab && activeTab.getAttribute('onclick')?.includes('showMy')) {
    showMy();
  }
};

// ---------- SHARE MODAL ----------
let currentShareHadith = null;

window.openShareModal = async (chp, id, ev) => {
  ev?.stopPropagation();
  
  // If the hadith is not in current chapter, we need to load its chapter
  if (!currentChapterHadiths || !currentChapterHadiths.some(h => parseInt(h.id) === parseInt(id))) {
    const chapter = chapters.find(c => c.id === parseInt(chp));
    if (chapter) {
      const chapterHadiths = await loadChapterHadiths(chapter);
      currentShareHadith = chapterHadiths.find(h => parseInt(h.id) === parseInt(id));
    }
  } else {
    currentShareHadith = currentChapterHadiths.find(h => parseInt(h.id) === parseInt(id));
  }
  
  if (currentShareHadith) {
    document.getElementById('share-modal').classList.add('show');
  }
};

window.closeShareModal = () => document.getElementById('share-modal').classList.remove('show');

window.shareHadith = async function() {
  if (!currentShareHadith) return;
  const incAr = document.getElementById('include-arabic').checked;
  const incTr = document.getElementById('include-translation').checked;
  const lang = document.getElementById('share-language').value;
  const bookName = currentShareHadith.book || "Sahih al-Bukhari";
  
  let shareText = `Hadith ${currentShareHadith.id} – ${bookName}, Vol ${currentShareHadith.volume}\n\n`;
  if (incAr) shareText += `${currentShareHadith.arabic}\n\n`;
  if (incTr) shareText += `${currentShareHadith[lang]}\n\n`;
  shareText += `— MuslimBro1400\nhttps://adil43534.github.io/Muslimbro1400.com/`;
  await navigator.clipboard.writeText(shareText);
  
  document.getElementById('copy-message').style.display = 'block';
  setTimeout(() => { 
    document.getElementById('copy-message').style.display = 'none'; 
    closeShareModal(); 
  }, 2000);
};

// ---------- MY HADITHS TAB (Now with fluid responsive chapter cards) ----------
window.showAll = function() {
  document.querySelectorAll('.tab-button').forEach(b=>b.classList.remove('active'));
  document.querySelector('button[onclick="showAll()"]').classList.add('active');
  grid.style.display = '';
  renderAllChapters();
};

window.showMy = function() {
  document.querySelectorAll('.tab-button').forEach(b=>b.classList.remove('active'));
  document.querySelector('button[onclick="showMy()"]').classList.add('active');
  
  // Hide the main grid
  grid.style.display = 'block';
  
  // Create fluid horizontal scrolling sections for saved items
  let html = '';
  
  // Favourited Chapters Section
  html += `<h2 class="my-hadiths-section-title">Favourited Chapters</h2>`;
  html += `<div class="horizontal-cards-container" id="favourited-chapters-container"><div class="horizontal-cards">Loading...</div></div>`;
  
  // Bookmarked Chapters Section
  html += `<h2 class="my-hadiths-section-title">Bookmarked Chapters</h2>`;
  html += `<div class="horizontal-cards-container" id="bookmarked-chapters-container"><div class="horizontal-cards">Loading...</div></div>`;
  
  // Favourited Hadiths Section
  html += `<h2 class="my-hadiths-section-title">Favourited Hadiths</h2>`;
  html += `<div class="horizontal-cards-container" id="favourited-hadiths-container"><div class="horizontal-cards">Loading...</div></div>`;
  
  // Bookmarked Hadiths Section
  html += `<h2 class="my-hadiths-section-title">Bookmarked Hadiths</h2>`;
  html += `<div class="horizontal-cards-container" id="bookmarked-hadiths-container"><div class="horizontal-cards">Loading...</div></div>`;
  
  grid.innerHTML = html;
  
  // Load favourited chapters with fluid cards
  loadSavedChaptersFluid('favourited', favoritedChapters, 'favourited-chapters-container');
  
  // Load bookmarked chapters with fluid cards
  loadSavedChaptersFluid('bookmarked', bookmarkedChapters, 'bookmarked-chapters-container');
  
  // Load favourited hadiths asynchronously
  loadSavedHadithsFluid('favourited', favoritedHadiths, 'favourited-hadiths-container');
  
  // Load bookmarked hadiths asynchronously
  loadSavedHadithsFluid('bookmarked', bookmarkedHadiths, 'bookmarked-hadiths-container');
};

// Helper function to load saved chapters with fluid responsive cards
function loadSavedChaptersFluid(type, savedList, containerId) {
  const container = document.getElementById(containerId);
  if (!container) return;
  
  // Get the horizontal-cards div inside
  const cardsContainer = container.querySelector('.horizontal-cards');
  if (!cardsContainer) return;
  
  if (!savedList.length) {
    cardsContainer.innerHTML = '<p style="padding:1rem;">No ' + type + ' chapters</p>';
    return;
  }
  
  let html = '';
  savedList.forEach(id => {
    let ch = chapters.find(c => c.id === id);
    if (ch) {
      const isFav = favoritedChapters.includes(ch.id);
      const isBkm = bookmarkedChapters.includes(ch.id);
      html += `<div class="card" onclick="openHadithModal(chapters.find(c=>c.id===${ch.id}), ${ch.id})">
        <img src="bukhari images/book${ch.id}.jpg" alt="${ch.title}" onerror="this.src='pic1.jpg'">
        <div class="icons">
          <span class="favorite-icon" onclick="event.stopPropagation(); toggleFavoriteChapter(${ch.id}); showMy();">${favSvg(type === 'favourited' ? true : isFav)}</span>
          <span class="bookmark-icon" onclick="event.stopPropagation(); toggleBookmarkChapter(${ch.id}); showMy();">${bkmSvg(type === 'bookmarked' ? true : isBkm)}</span>
        </div>
        <div class="overlay">
          <span class="surah-number">Book ${ch.id}: ${ch.title}</span>
        </div>
      </div>`;
    }
  });
  
  cardsContainer.innerHTML = html || '<p style="padding:1rem;">No ' + type + ' chapters</p>';
}

// Helper function to load saved hadiths with fluid responsive ayah cards
async function loadSavedHadithsFluid(type, savedList, containerId) {
  const container = document.getElementById(containerId);
  if (!container) return;
  
  // Get the horizontal-cards div inside
  const cardsContainer = container.querySelector('.horizontal-cards');
  if (!cardsContainer) return;
  
  if (!savedList.length) {
    cardsContainer.innerHTML = '<p style="padding:1rem;">No ' + type + ' hadiths</p>';
    return;
  }
  
  // Show loading state
  cardsContainer.innerHTML = '<div class="loading-spinner" style="padding:1rem;">Loading...</div>';
  
  let html = '';
  const chaptersToLoad = {};
  
  // Group by chapter
  savedList.forEach(item => {
    const chp = parseInt(item.chp);
    if (!chaptersToLoad[chp]) {
      chaptersToLoad[chp] = [];
    }
    chaptersToLoad[chp].push(parseInt(item.id));
  });
  
  // Load each chapter's hadiths
  for (const chp of Object.keys(chaptersToLoad)) {
    const chapter = chapters.find(c => c.id === parseInt(chp));
    if (!chapter) continue;
    
    const chapterHadiths = await loadChapterHadiths(chapter);
    const hadithIds = chaptersToLoad[chp];
    
    hadithIds.forEach(id => {
      const hadith = chapterHadiths.find(h => parseInt(h.id) === id);
      if (hadith) {
        const bookName = hadith.book || "Sahih al-Bukhari";
        html += `<div class="ayah-card" onclick="openHadithModal(chapters.find(c=>c.id===${hadith.chp}), ${hadith.id});">
          <span class="hadith-number">${bookName} | Hadith ${hadith.id} | ${hadith.chp_title}</span>
          <div class="hadith-text">${hadith.arabic.substring(0,80)}…</div>
          <button onclick="event.stopPropagation(); ${type === 'favourited' ? 'toggleFavoriteHadith' : 'toggleBookmarkHadith'}(${hadith.chp},${hadith.id},event); showMy();">Remove</button>
        </div>`;
      }
    });
  }
  
  cardsContainer.innerHTML = html || '<p style="padding:1rem;">No ' + type + ' hadiths found</p>';
}

// ---------- UTILITIES ----------
window.toggleTheme = function() { 
  document.body.classList.toggle('dark-mode'); 
  localStorage.setItem('theme', document.body.classList.contains('dark-mode')?'dark':'light');
  document.getElementById('theme-icon').src = document.body.classList.contains('dark-mode') ? "sun.png" : "moon.png";
};

window.toggleMenu = function() { 
  document.querySelector('.nav-links').classList.toggle('active'); 
};

window.scrollToTop = function() { 
  window.scrollTo({top:0,behavior:'smooth'}); 
};

window.onscroll = function() { 
  const btn = document.getElementById('scrollToTop'); 
  window.scrollY>300 ? btn.classList.add('show') : btn.classList.remove('show'); 
};

// ---------- INITIALIZATION ----------
window.onload = async function() {
  // Set theme
  if (localStorage.getItem('theme')==='dark') document.body.classList.add('dark-mode');
  document.getElementById('theme-icon').src = document.body.classList.contains('dark-mode') ? "sun.png" : "moon.png";
  
  // First, load all chapters that have saved hadiths
  await loadAllSavedChapters();
  
  // Then check which tab should be active
  const activeTab = document.querySelector('.tab-button.active');
  if (activeTab && activeTab.getAttribute('onclick')?.includes('showMy')) {
    // If My Hadiths tab was active, show it
    showMy();
  } else {
    // Otherwise show all chapters
    renderAllChapters();
  }
};

// Add CSS for spinner and animations
const style = document.createElement('style');
style.textContent = `
  .loading-spinner {
    text-align: center;
    padding: 2rem;
    font-size: 1.2rem;
    color: #0c8;
  }
  .loading-spinner::after {
    content: '';
    display: inline-block;
    width: 1rem;
    height: 1rem;
    margin-left: 0.5rem;
    border: 2px solid #0c8;
    border-top-color: transparent;
    border-radius: 50%;
    animation: spin 0.8s linear infinite;
  }
  @keyframes spin {
    to { transform: rotate(360deg); }
  }
  
  .error-placeholder {
    display: none;
  }
`;
document.head.appendChild(style);
</script>
</body>
</html>
